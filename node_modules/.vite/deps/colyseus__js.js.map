{
  "version": 3,
  "sources": ["../../../../node_modules/colyseus.js/src/legacy.ts", "../../../../node_modules/colyseus.js/src/errors/Errors.ts", "../../../../node_modules/colyseus.js/src/transport/H3Transport.ts", "../../../../node_modules/ws/browser.js", "../../../../node_modules/colyseus.js/src/transport/WebSocketTransport.ts", "../../../../node_modules/colyseus.js/src/Connection.ts", "../../../../node_modules/colyseus.js/src/Protocol.ts", "../../../../node_modules/colyseus.js/src/serializer/Serializer.ts", "../../../../node_modules/colyseus.js/src/core/nanoevents.ts", "../../../../node_modules/colyseus.js/src/core/signal.ts", "../../../../node_modules/colyseus.js/src/serializer/SchemaSerializer.ts", "../../../../node_modules/@colyseus/msgpackr/unpack.js", "../../../../node_modules/@colyseus/msgpackr/pack.js", "../../../../node_modules/@colyseus/msgpackr/iterators.js", "../../../../node_modules/@colyseus/msgpackr/index.js", "../../../../node_modules/colyseus.js/src/Room.ts", "../../../../node_modules/@colyseus/httpie/xhr/index.mjs", "../../../../node_modules/colyseus.js/src/HTTP.ts", "../../../../node_modules/colyseus.js/src/Storage.ts", "../../../../node_modules/colyseus.js/src/Auth.ts", "../../../../node_modules/colyseus.js/src/3rd_party/discord.ts", "../../../../node_modules/colyseus.js/src/Client.ts", "../../../../node_modules/colyseus.js/src/serializer/NoneSerializer.ts", "../../../../node_modules/colyseus.js/src/index.ts"],
  "sourcesContent": ["//\n// Polyfills for legacy environments\n//\n\n/*\n * Support Android 4.4.x\n */\nif (!ArrayBuffer.isView) {\n    ArrayBuffer.isView = (a: any): a is ArrayBufferView => {\n        return a !== null && typeof (a) === 'object' && a.buffer instanceof ArrayBuffer;\n    };\n}\n\n// Define globalThis if not available.\n// https://github.com/colyseus/colyseus.js/issues/86\nif (\n    typeof (globalThis) === \"undefined\" &&\n    typeof (window) !== \"undefined\"\n) {\n    // @ts-ignore\n    window['globalThis'] = window;\n}\n\n// Cocos Creator does not provide \"FormData\"\n// Define a dummy implementation so it doesn't crash\nif (typeof(FormData) === \"undefined\") {\n    // @ts-ignore\n    globalThis['FormData'] = class {};\n}", "export enum CloseCode {\n    CONSENTED = 4000,\n    DEVMODE_RESTART = 4010\n}\n\nexport class ServerError extends Error {\n  public code: number;\n\n  constructor(code: number, message: string) {\n    super(message);\n\n    this.name = \"ServerError\";\n    this.code = code;\n  }\n}\n\nexport class AbortError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"AbortError\";\n  }\n}\n", "import { ITransport, ITransportEventMap } from \"./ITransport\";\nimport { encode, decode, Iterator } from '@colyseus/schema';\n\nexport class H3TransportTransport implements ITransport {\n    wt: WebTransport;\n    isOpen: boolean = false;\n\n    reader: ReadableStreamDefaultReader;\n    writer: WritableStreamDefaultWriter;\n\n    unreliableReader: ReadableStreamDefaultReader<Uint8Array>;\n    unreliableWriter: WritableStreamDefaultWriter<Uint8Array>;\n\n    private lengthPrefixBuffer = new Uint8Array(9); // 9 bytes is the maximum length of a length prefix\n\n    constructor(public events: ITransportEventMap) { }\n\n    public connect(url: string, options: any = {}) {\n        const wtOpts: WebTransportOptions = options.fingerprint && ({\n            // requireUnreliable: true,\n            // congestionControl: \"default\", // \"low-latency\" || \"throughput\"\n\n            serverCertificateHashes: [{\n                algorithm: 'sha-256',\n                value: new Uint8Array(options.fingerprint).buffer\n            }]\n        }) || undefined;\n\n        this.wt = new WebTransport(url, wtOpts);\n\n        this.wt.ready.then((e) => {\n            console.log(\"WebTransport ready!\", e)\n            this.isOpen = true;\n\n            this.unreliableReader = this.wt.datagrams.readable.getReader();\n            this.unreliableWriter = this.wt.datagrams.writable.getWriter();\n\n            const incomingBidi = this.wt.incomingBidirectionalStreams.getReader();\n            incomingBidi.read().then((stream) => {\n                this.reader = stream.value.readable.getReader();\n                this.writer = stream.value.writable.getWriter();\n\n                // immediately write room/sessionId for establishing the room connection\n                this.sendSeatReservation(options.room.roomId, options.sessionId, options.reconnectionToken);\n\n                // start reading incoming data\n                this.readIncomingData();\n                this.readIncomingUnreliableData();\n\n            }).catch((e) => {\n                console.error(\"failed to read incoming stream\", e);\n                console.error(\"TODO: close the connection\");\n            });\n\n            // this.events.onopen(e);\n        }).catch((e: WebTransportCloseInfo) => {\n            // this.events.onerror(e);\n            // this.events.onclose({ code: e.closeCode, reason: e.reason });\n            console.log(\"WebTransport not ready!\", e)\n            this._close();\n        });\n\n        this.wt.closed.then((e: WebTransportCloseInfo) => {\n            console.log(\"WebTransport closed w/ success\", e)\n            this.events.onclose({ code: e.closeCode, reason: e.reason });\n\n        }).catch((e: WebTransportCloseInfo) => {\n            console.log(\"WebTransport closed w/ error\", e)\n            this.events.onerror(e);\n            this.events.onclose({ code: e.closeCode, reason: e.reason });\n        }).finally(() => {\n            this._close();\n        });\n    }\n\n    public send(data: Buffer | Uint8Array): void {\n        const prefixLength = encode.number(this.lengthPrefixBuffer as any, data.length, { offset: 0 });\n        const dataWithPrefixedLength = new Uint8Array(prefixLength + data.length);\n        dataWithPrefixedLength.set(this.lengthPrefixBuffer.subarray(0, prefixLength), 0);\n        dataWithPrefixedLength.set(data, prefixLength);\n        this.writer.write(dataWithPrefixedLength);\n    }\n\n    public sendUnreliable(data: Buffer | Uint8Array): void {\n        const prefixLength = encode.number(this.lengthPrefixBuffer as any, data.length, { offset: 0 });\n        const dataWithPrefixedLength = new Uint8Array(prefixLength + data.length);\n        dataWithPrefixedLength.set(this.lengthPrefixBuffer.subarray(0, prefixLength), 0);\n        dataWithPrefixedLength.set(data, prefixLength);\n        this.unreliableWriter.write(dataWithPrefixedLength);\n    }\n\n    public close(code?: number, reason?: string) {\n        try {\n            this.wt.close({ closeCode: code, reason: reason });\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    protected async readIncomingData() {\n        let result: ReadableStreamReadResult<Uint8Array>;\n\n        while (this.isOpen) {\n            try {\n                result = await this.reader.read();\n\n                //\n                // a single read may contain multiple messages\n                // each message is prefixed with its length\n                //\n\n                const messages = result.value;\n                const it: Iterator = { offset: 0 };\n                do {\n                    //\n                    // QUESTION: should we buffer the message in case it's not fully read?\n                    //\n\n                    const length = decode.number(messages as any, it);\n                    this.events.onmessage({ data: messages.subarray(it.offset, it.offset + length) });\n                    it.offset += length;\n                } while (it.offset < messages.length);\n\n            } catch (e) {\n                if (e.message.indexOf(\"session is closed\") === -1) {\n                    console.error(\"H3Transport: failed to read incoming data\", e);\n                }\n                break;\n            }\n\n            if (result.done) {\n                break;\n            }\n        }\n    }\n\n    protected async readIncomingUnreliableData() {\n        let result: ReadableStreamReadResult<Uint8Array>;\n\n        while (this.isOpen) {\n            try {\n                result = await this.unreliableReader.read();\n\n                //\n                // a single read may contain multiple messages\n                // each message is prefixed with its length\n                //\n\n                const messages = result.value;\n                const it: Iterator = { offset: 0 };\n                do {\n                    //\n                    // QUESTION: should we buffer the message in case it's not fully read?\n                    //\n\n                    const length = decode.number(messages as any, it);\n                    this.events.onmessage({ data: messages.subarray(it.offset, it.offset + length) });\n                    it.offset += length;\n                } while (it.offset < messages.length);\n\n            } catch (e) {\n                if (e.message.indexOf(\"session is closed\") === -1) {\n                    console.error(\"H3Transport: failed to read incoming data\", e);\n                }\n                break;\n            }\n\n            if (result.done) {\n                break;\n            }\n        }\n    }\n\n    protected sendSeatReservation (roomId: string, sessionId: string, reconnectionToken?: string) {\n        const it: Iterator = { offset: 0 };\n        const bytes: number[] = [];\n\n        encode.string(bytes, roomId, it);\n        encode.string(bytes, sessionId, it);\n\n        if (reconnectionToken) {\n            encode.string(bytes, reconnectionToken, it);\n        }\n\n        this.writer.write(new Uint8Array(bytes).buffer);\n    }\n\n    protected _close() {\n        this.isOpen = false;\n    }\n\n}\n", "'use strict';\n\nmodule.exports = function () {\n  throw new Error(\n    'ws does not work in the browser. Browser clients must use the native ' +\n      'WebSocket object'\n  );\n};\n", "import NodeWebSocket from \"ws\";\nimport { ITransport, ITransportEventMap } from \"./ITransport\";\n\nconst WebSocket = globalThis.WebSocket || NodeWebSocket;\n\nexport class WebSocketTransport implements ITransport {\n    ws: WebSocket | NodeWebSocket;\n    protocols?: string | string[];\n\n    constructor(public events: ITransportEventMap) {}\n\n    public send(data: Buffer | Uint8Array): void {\n        this.ws.send(data);\n    }\n\n    public sendUnreliable(data: ArrayBuffer | Array<number>): void {\n        console.warn(\"colyseus.js: The WebSocket transport does not support unreliable messages\");\n    }\n\n    /**\n     * @param url URL to connect to\n     * @param headers custom headers to send with the connection (only supported in Node.js. Web Browsers do not allow setting custom headers)\n     */\n    public connect(url: string, headers?: any): void {\n        try {\n            // Node or Bun environments (supports custom headers)\n            this.ws = new WebSocket(url, { headers, protocols: this.protocols });\n\n        } catch (e) {\n            // browser environment (custom headers not supported)\n            this.ws = new WebSocket(url, this.protocols);\n        }\n\n        this.ws.binaryType = 'arraybuffer';\n        this.ws.onopen = this.events.onopen;\n        this.ws.onmessage = this.events.onmessage;\n        this.ws.onclose = this.events.onclose;\n        this.ws.onerror = this.events.onerror;\n    }\n\n    public close(code?: number, reason?: string) {\n        this.ws.close(code, reason);\n    }\n\n    get isOpen() {\n        return this.ws.readyState === WebSocket.OPEN;\n    }\n\n}\n", "import { H3TransportTransport } from \"./transport/H3Transport\";\nimport { ITransport, ITransportEventMap } from \"./transport/ITransport\";\nimport { WebSocketTransport } from \"./transport/WebSocketTransport\";\n\nexport class Connection implements ITransport {\n    transport: ITransport;\n    events: ITransportEventMap = {};\n\n    constructor(protocol?: string) {\n        switch (protocol) {\n            case \"h3\":\n                this.transport = new H3TransportTransport(this.events);\n                break;\n\n            default:\n                this.transport = new WebSocketTransport(this.events);\n                break;\n        }\n    }\n\n    connect(url: string, options?: any): void {\n        this.transport.connect.call(this.transport, url, options);\n    }\n\n    send(data: Buffer | Uint8Array): void {\n        this.transport.send(data);\n    }\n\n    sendUnreliable(data: Buffer | Uint8Array): void {\n        this.transport.sendUnreliable(data);\n    }\n\n    close(code?: number, reason?: string): void {\n        this.transport.close(code, reason);\n    }\n\n    get isOpen() {\n        return this.transport.isOpen;\n    }\n\n}\n", "import { RoomAvailable } from \"./Room\";\n\nexport interface SeatReservation {\n    room: RoomAvailable;\n    sessionId: string;\n    reconnectionToken?: string;\n    devMode?: boolean;\n    protocol?: string;\n}\n\n// Use codes between 0~127 for lesser throughput (1 byte)\nexport enum Protocol {\n    // Room-related (10~19)\n    HANDSHAKE = 9,\n    JOIN_ROOM = 10,\n    ERROR = 11,\n    LEAVE_ROOM = 12,\n    ROOM_DATA = 13,\n    ROOM_STATE = 14,\n    ROOM_STATE_PATCH = 15,\n    ROOM_DATA_SCHEMA = 16,\n    ROOM_DATA_BYTES = 17,\n}\n\nexport enum ErrorCode {\n    MATCHMAKE_NO_HANDLER = 4210,\n    MATCHMAKE_INVALID_CRITERIA = 4211,\n    MATCHMAKE_INVALID_ROOM_ID = 4212,\n    MATCHMAKE_UNHANDLED = 4213,\n    MATCHMAKE_EXPIRED = 4214,\n\n    AUTH_FAILED = 4215,\n    APPLICATION_ERROR = 4216,\n}\n", "import type { Iterator } from \"@colyseus/schema\";\n\nexport type BufferLike = number[] | Uint8Array | Buffer;\n\nexport interface Serializer<State> {\n    setState(data: BufferLike, it?: Iterator): void;\n    getState(): State;\n\n    patch(data: BufferLike, it?: Iterator): void;\n    teardown(): void;\n\n    handshake?(bytes: BufferLike, it?: any): void;\n}\n\nconst serializers: { [id: string]: any } = {};\n\nexport function registerSerializer (id: string, serializer: any) {\n    serializers[id] = serializer;\n}\n\nexport function getSerializer (id: string) {\n    const serializer = serializers[id];\n    if (!serializer) { throw new Error(\"missing serializer: \" + id); }\n    return serializer;\n}", "/**\n * The MIT License (MIT)\n *\n * Copyright 2016 Andrey Sitnik <andrey@sitnik.ru>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nexport const createNanoEvents = () => ({\n    emit(event: string, ...args: any[]) {\n        let callbacks = this.events[event] || []\n        for (let i = 0, length = callbacks.length; i < length; i++) {\n            callbacks[i](...args)\n        }\n    },\n    events: {},\n    on(event: string, cb: (...args: any[]) => void) {\n        this.events[event]?.push(cb) || (this.events[event] = [cb])\n        return () => {\n            this.events[event] = this.events[event]?.filter(i => cb !== i)\n        }\n    }\n});", "type FunctionParameters<T extends (...args: any[]) => any> =\n  T extends (...args: infer P) => any\n    ? P\n    : never;\n\nexport class EventEmitter<CallbackSignature extends (...args: any[]) => any> {\n  handlers: Array<CallbackSignature> = [];\n\n  register(cb: CallbackSignature, once: boolean = false) {\n    this.handlers.push(cb);\n    return this;\n  }\n\n  invoke(...args: FunctionParameters<CallbackSignature>) {\n    this.handlers.forEach((handler) => handler.apply(this, args));\n  }\n\n  invokeAsync(...args: FunctionParameters<CallbackSignature>) {\n    return Promise.all(this.handlers.map((handler) => handler.apply(this, args)));\n  }\n\n  remove (cb: CallbackSignature) {\n    const index = this.handlers.indexOf(cb);\n    this.handlers[index] = this.handlers[this.handlers.length - 1];\n    this.handlers.pop();\n  }\n\n  clear() {\n    this.handlers = [];\n  }\n}\n\nexport function createSignal<CallbackSignature extends (...args: any[]) => void | Promise<any>>()\n  : \n   {\n    once: (cb: CallbackSignature) => void;\n    remove: (cb: CallbackSignature) => void,\n    invoke: (...args: FunctionParameters<CallbackSignature>) => void,\n    invokeAsync: (...args: FunctionParameters<CallbackSignature>) => Promise<any[]>,\n    clear: () => void,\n  } & ((this: any, cb: CallbackSignature) => EventEmitter<CallbackSignature> )\n  {\n  const emitter = new EventEmitter<CallbackSignature>();\n\n  function register(this: any, cb: CallbackSignature): EventEmitter<CallbackSignature> {\n    return emitter.register(cb, this === null);\n  };\n\n  register.once = (cb: CallbackSignature) => {\n    const callback: any = function (...args: any[]) {\n      cb.apply(this, args);\n      emitter.remove(callback);\n    }\n    emitter.register(callback);\n  }\n  register.remove = (cb: CallbackSignature) => emitter.remove(cb)\n  register.invoke = (...args: FunctionParameters<CallbackSignature>) => emitter.invoke(...args);\n  register.invokeAsync = (...args: FunctionParameters<CallbackSignature>) => emitter.invokeAsync(...args);\n  register.clear = () => emitter.clear();\n\n  return register;\n}", "import { Serializer } from \"./Serializer\";\nimport { Schema, Decoder, Reflection, Iterator, getDecoderStateCallbacks } from \"@colyseus/schema\";\nimport type { Room } from \"../Room\";\n\nexport type SchemaConstructor<T = Schema> = new (...args: any[]) => T;\n\n//\n// TODO: use a schema interface, which even having duplicate definitions, it could be used to get the callback proxy.\n// \n// ```ts\n//     export type SchemaCallbackProxy<RoomState> = (<T extends ISchema>(instance: T) => CallbackProxy<T>);\n//     export function getStateCallbacks<T extends ISchema>(room: Room<T>) {\n// ```\n//\nexport function getStateCallbacks<T>(room: Room<T>) {\n    try {\n        // SchemaSerializer\n        // @ts-ignore\n        return getDecoderStateCallbacks<T>((room['serializer'] as unknown as SchemaSerializer<T>).decoder);\n    } catch (e) {\n        // NoneSerializer\n        return undefined;\n    }\n}\n\nexport class SchemaSerializer<T extends Schema = any> implements Serializer<T> {\n    state: T;\n    decoder: Decoder<T>;\n\n    setState(encodedState: Buffer, it?: Iterator) {\n        this.decoder.decode(encodedState, it);\n    }\n\n    getState() {\n        return this.state;\n    }\n\n    patch(patches: Buffer, it?: Iterator) {\n        return this.decoder.decode(patches, it);\n    }\n\n    teardown() {\n        this.decoder.root.clearRefs();\n    }\n\n    handshake(bytes: Buffer, it?: Iterator) {\n        if (this.state) {\n            //\n            // TODO: validate definitions against concreate this.state instance\n            //\n            Reflection.decode(bytes, it); // no-op\n\n            this.decoder = new Decoder(this.state);\n\n        } else {\n            // initialize reflected state from server\n            this.decoder = Reflection.decode(bytes, it);\n            this.state = this.decoder.state;\n        }\n    }\n}\n", "var decoder\ntry {\n\tdecoder = new TextDecoder()\n} catch(error) {}\nvar src\nvar srcEnd\nvar position = 0\nvar alreadySet\nconst EMPTY_ARRAY = []\nvar strings = EMPTY_ARRAY\nvar stringPosition = 0\nvar currentUnpackr = {}\nvar currentStructures\nvar srcString\nvar srcStringStart = 0\nvar srcStringEnd = 0\nvar bundledStrings\nvar referenceMap\nvar currentExtensions = []\nvar dataView\nvar defaultOptions = {\n\tuseRecords: false,\n\tmapsAsObjects: true\n}\nexport class C1Type {}\nexport const C1 = new C1Type()\nC1.name = 'MessagePack 0xC1'\nvar sequentialMode = false\nvar inlineObjectReadThreshold = 2\nvar readStruct, onLoadedStructures, onSaveState\nvar BlockedFunction // we use search and replace to change the next call to BlockedFunction to avoid CSP issues for\n// no-eval build\ntry {\n\tnew Function('')\n} catch(error) {\n\t// if eval variants are not supported, do not create inline object readers ever\n\tinlineObjectReadThreshold = Infinity\n}\n\nexport class Unpackr {\n\tconstructor(options) {\n\t\tif (options) {\n\t\t\tif (options.useRecords === false && options.mapsAsObjects === undefined)\n\t\t\t\toptions.mapsAsObjects = true\n\t\t\tif (options.sequential && options.trusted !== false) {\n\t\t\t\toptions.trusted = true;\n\t\t\t\tif (!options.structures && options.useRecords != false) {\n\t\t\t\t\toptions.structures = []\n\t\t\t\t\tif (!options.maxSharedStructures)\n\t\t\t\t\t\toptions.maxSharedStructures = 0\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (options.structures)\n\t\t\t\toptions.structures.sharedLength = options.structures.length\n\t\t\telse if (options.getStructures) {\n\t\t\t\t(options.structures = []).uninitialized = true // this is what we use to denote an uninitialized structures\n\t\t\t\toptions.structures.sharedLength = 0\n\t\t\t}\n\t\t\tif (options.int64AsNumber) {\n\t\t\t\toptions.int64AsType = 'number'\n\t\t\t}\n\t\t}\n\t\tObject.assign(this, options)\n\t}\n\tunpack(source, options) {\n\t\tif (src) {\n\t\t\t// re-entrant execution, save the state and restore it after we do this unpack\n\t\t\treturn saveState(() => {\n\t\t\t\tclearSource()\n\t\t\t\treturn this ? this.unpack(source, options) : Unpackr.prototype.unpack.call(defaultOptions, source, options)\n\t\t\t})\n\t\t}\n\t\tif (!source.buffer && source.constructor === ArrayBuffer)\n\t\t\tsource = typeof Buffer !== 'undefined' ? Buffer.from(source) : new Uint8Array(source);\n\t\tif (typeof options === 'object') {\n\t\t\tsrcEnd = options.end || source.length\n\t\t\tposition = options.start || 0\n\t\t} else {\n\t\t\tposition = 0\n\t\t\tsrcEnd = options > -1 ? options : source.length\n\t\t}\n\t\tstringPosition = 0\n\t\tsrcStringEnd = 0\n\t\tsrcString = null\n\t\tstrings = EMPTY_ARRAY\n\t\tbundledStrings = null\n\t\tsrc = source\n\t\t// this provides cached access to the data view for a buffer if it is getting reused, which is a recommend\n\t\t// technique for getting data from a database where it can be copied into an existing buffer instead of creating\n\t\t// new ones\n\t\ttry {\n\t\t\tdataView = source.dataView || (source.dataView = new DataView(source.buffer, source.byteOffset, source.byteLength))\n\t\t} catch(error) {\n\t\t\t// if it doesn't have a buffer, maybe it is the wrong type of object\n\t\t\tsrc = null\n\t\t\tif (source instanceof Uint8Array)\n\t\t\t\tthrow error\n\t\t\tthrow new Error('Source must be a Uint8Array or Buffer but was a ' + ((source && typeof source == 'object') ? source.constructor.name : typeof source))\n\t\t}\n\t\tif (this instanceof Unpackr) {\n\t\t\tcurrentUnpackr = this\n\t\t\tif (this.structures) {\n\t\t\t\tcurrentStructures = this.structures\n\t\t\t\treturn checkedRead(options)\n\t\t\t} else if (!currentStructures || currentStructures.length > 0) {\n\t\t\t\tcurrentStructures = []\n\t\t\t}\n\t\t} else {\n\t\t\tcurrentUnpackr = defaultOptions\n\t\t\tif (!currentStructures || currentStructures.length > 0)\n\t\t\t\tcurrentStructures = []\n\t\t}\n\t\treturn checkedRead(options)\n\t}\n\tunpackMultiple(source, forEach) {\n\t\tlet values, lastPosition = 0\n\t\ttry {\n\t\t\tsequentialMode = true\n\t\t\tlet size = source.length\n\t\t\tlet value = this ? this.unpack(source, size) : defaultUnpackr.unpack(source, size)\n\t\t\tif (forEach) {\n\t\t\t\tif (forEach(value, lastPosition, position) === false) return;\n\t\t\t\twhile(position < size) {\n\t\t\t\t\tlastPosition = position\n\t\t\t\t\tif (forEach(checkedRead(), lastPosition, position) === false) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvalues = [ value ]\n\t\t\t\twhile(position < size) {\n\t\t\t\t\tlastPosition = position\n\t\t\t\t\tvalues.push(checkedRead())\n\t\t\t\t}\n\t\t\t\treturn values\n\t\t\t}\n\t\t} catch(error) {\n\t\t\terror.lastPosition = lastPosition\n\t\t\terror.values = values\n\t\t\tthrow error\n\t\t} finally {\n\t\t\tsequentialMode = false\n\t\t\tclearSource()\n\t\t}\n\t}\n\t_mergeStructures(loadedStructures, existingStructures) {\n\t\tif (onLoadedStructures)\n\t\t\tloadedStructures = onLoadedStructures.call(this, loadedStructures);\n\t\tloadedStructures = loadedStructures || []\n\t\tif (Object.isFrozen(loadedStructures))\n\t\t\tloadedStructures = loadedStructures.map(structure => structure.slice(0))\n\t\tfor (let i = 0, l = loadedStructures.length; i < l; i++) {\n\t\t\tlet structure = loadedStructures[i]\n\t\t\tif (structure) {\n\t\t\t\tstructure.isShared = true\n\t\t\t\tif (i >= 32)\n\t\t\t\t\tstructure.highByte = (i - 32) >> 5\n\t\t\t}\n\t\t}\n\t\tloadedStructures.sharedLength = loadedStructures.length\n\t\tfor (let id in existingStructures || []) {\n\t\t\tif (id >= 0) {\n\t\t\t\tlet structure = loadedStructures[id]\n\t\t\t\tlet existing = existingStructures[id]\n\t\t\t\tif (existing) {\n\t\t\t\t\tif (structure)\n\t\t\t\t\t\t(loadedStructures.restoreStructures || (loadedStructures.restoreStructures = []))[id] = structure\n\t\t\t\t\tloadedStructures[id] = existing\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.structures = loadedStructures\n\t}\n\tdecode(source, options) {\n\t\treturn this.unpack(source, options)\n\t}\n}\nexport function getPosition() {\n\treturn position\n}\nexport function checkedRead(options) {\n\ttry {\n\t\tif (!currentUnpackr.trusted && !sequentialMode) {\n\t\t\tlet sharedLength = currentStructures.sharedLength || 0\n\t\t\tif (sharedLength < currentStructures.length)\n\t\t\t\tcurrentStructures.length = sharedLength\n\t\t}\n\t\tlet result\n\t\tif (currentUnpackr.randomAccessStructure && src[position] < 0x40 && src[position] >= 0x20 && readStruct) {\n\t\t\tresult = readStruct(src, position, srcEnd, currentUnpackr)\n\t\t\tsrc = null // dispose of this so that recursive unpack calls don't save state\n\t\t\tif (!(options && options.lazy) && result)\n\t\t\t\tresult = result.toJSON()\n\t\t\tposition = srcEnd\n\t\t} else\n\t\t\tresult = read()\n\t\tif (bundledStrings) { // bundled strings to skip past\n\t\t\tposition = bundledStrings.postBundlePosition\n\t\t\tbundledStrings = null\n\t\t}\n\t\tif (sequentialMode)\n\t\t\t// we only need to restore the structures if there was an error, but if we completed a read,\n\t\t\t// we can clear this out and keep the structures we read\n\t\t\tcurrentStructures.restoreStructures = null\n\n\t\tif (position == srcEnd) {\n\t\t\t// finished reading this source, cleanup references\n\t\t\tif (currentStructures && currentStructures.restoreStructures)\n\t\t\t\trestoreStructures()\n\t\t\tcurrentStructures = null\n\t\t\tsrc = null\n\t\t\tif (referenceMap)\n\t\t\t\treferenceMap = null\n\t\t} else if (position > srcEnd) {\n\t\t\t// over read\n\t\t\tthrow new Error('Unexpected end of MessagePack data')\n\t\t} else if (!sequentialMode) {\n\t\t\tlet jsonView;\n\t\t\ttry {\n\t\t\t\tjsonView = JSON.stringify(result, (_, value) => typeof value === \"bigint\" ? `${value}n` : value).slice(0, 100)\n\t\t\t} catch(error) {\n\t\t\t\tjsonView = '(JSON view not available ' + error + ')'\n\t\t\t}\n\t\t\tthrow new Error('Data read, but end of buffer not reached ' + jsonView)\n\t\t}\n\t\t// else more to read, but we are reading sequentially, so don't clear source yet\n\t\treturn result\n\t} catch(error) {\n\t\tif (currentStructures && currentStructures.restoreStructures)\n\t\t\trestoreStructures()\n\t\tclearSource()\n\t\tif (error instanceof RangeError || error.message.startsWith('Unexpected end of buffer') || position > srcEnd) {\n\t\t\terror.incomplete = true\n\t\t}\n\t\tthrow error\n\t}\n}\n\nfunction restoreStructures() {\n\tfor (let id in currentStructures.restoreStructures) {\n\t\tcurrentStructures[id] = currentStructures.restoreStructures[id]\n\t}\n\tcurrentStructures.restoreStructures = null\n}\n\nexport function read() {\n\tlet token = src[position++]\n\tif (token < 0xa0) {\n\t\tif (token < 0x80) {\n\t\t\tif (token < 0x40)\n\t\t\t\treturn token\n\t\t\telse {\n\t\t\t\tlet structure = currentStructures[token & 0x3f] ||\n\t\t\t\t\tcurrentUnpackr.getStructures && loadStructures()[token & 0x3f]\n\t\t\t\tif (structure) {\n\t\t\t\t\tif (!structure.read) {\n\t\t\t\t\t\tstructure.read = createStructureReader(structure, token & 0x3f)\n\t\t\t\t\t}\n\t\t\t\t\treturn structure.read()\n\t\t\t\t} else\n\t\t\t\t\treturn token\n\t\t\t}\n\t\t} else if (token < 0x90) {\n\t\t\t// map\n\t\t\ttoken -= 0x80\n\t\t\tif (currentUnpackr.mapsAsObjects) {\n\t\t\t\tlet object = {}\n\t\t\t\tfor (let i = 0; i < token; i++) {\n\t\t\t\t\tlet key = readKey()\n\t\t\t\t\tif (key === '__proto__')\n\t\t\t\t\t\tkey = '__proto_'\n\t\t\t\t\tobject[key] = read()\n\t\t\t\t}\n\t\t\t\treturn object\n\t\t\t} else {\n\t\t\t\tlet map = new Map()\n\t\t\t\tfor (let i = 0; i < token; i++) {\n\t\t\t\t\tmap.set(read(), read())\n\t\t\t\t}\n\t\t\t\treturn map\n\t\t\t}\n\t\t} else {\n\t\t\ttoken -= 0x90\n\t\t\tlet array = new Array(token)\n\t\t\tfor (let i = 0; i < token; i++) {\n\t\t\t\tarray[i] = read()\n\t\t\t}\n\t\t\tif (currentUnpackr.freezeData)\n\t\t\t\treturn Object.freeze(array)\n\t\t\treturn array\n\t\t}\n\t} else if (token < 0xc0) {\n\t\t// fixstr\n\t\tlet length = token - 0xa0\n\t\tif (srcStringEnd >= position) {\n\t\t\treturn srcString.slice(position - srcStringStart, (position += length) - srcStringStart)\n\t\t}\n\t\tif (srcStringEnd == 0 && srcEnd < 140) {\n\t\t\t// for small blocks, avoiding the overhead of the extract call is helpful\n\t\t\tlet string = length < 16 ? shortStringInJS(length) : longStringInJS(length)\n\t\t\tif (string != null)\n\t\t\t\treturn string\n\t\t}\n\t\treturn readFixedString(length)\n\t} else {\n\t\tlet value\n\t\tswitch (token) {\n\t\t\tcase 0xc0: return null\n\t\t\tcase 0xc1:\n\t\t\t\tif (bundledStrings) {\n\t\t\t\t\tvalue = read() // followed by the length of the string in characters (not bytes!)\n\t\t\t\t\tif (value > 0)\n\t\t\t\t\t\treturn bundledStrings[1].slice(bundledStrings.position1, bundledStrings.position1 += value)\n\t\t\t\t\telse\n\t\t\t\t\t\treturn bundledStrings[0].slice(bundledStrings.position0, bundledStrings.position0 -= value)\n\t\t\t\t}\n\t\t\t\treturn C1; // \"never-used\", return special object to denote that\n\t\t\tcase 0xc2: return false\n\t\t\tcase 0xc3: return true\n\t\t\tcase 0xc4:\n\t\t\t\t// bin 8\n\t\t\t\tvalue = src[position++]\n\t\t\t\tif (value === undefined)\n\t\t\t\t\tthrow new Error('Unexpected end of buffer')\n\t\t\t\treturn readBin(value)\n\t\t\tcase 0xc5:\n\t\t\t\t// bin 16\n\t\t\t\tvalue = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\treturn readBin(value)\n\t\t\tcase 0xc6:\n\t\t\t\t// bin 32\n\t\t\t\tvalue = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\treturn readBin(value)\n\t\t\tcase 0xc7:\n\t\t\t\t// ext 8\n\t\t\t\treturn readExt(src[position++])\n\t\t\tcase 0xc8:\n\t\t\t\t// ext 16\n\t\t\t\tvalue = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\treturn readExt(value)\n\t\t\tcase 0xc9:\n\t\t\t\t// ext 32\n\t\t\t\tvalue = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\treturn readExt(value)\n\t\t\tcase 0xca:\n\t\t\t\tvalue = dataView.getFloat32(position)\n\t\t\t\tif (currentUnpackr.useFloat32 > 2) {\n\t\t\t\t\t// this does rounding of numbers that were encoded in 32-bit float to nearest significant decimal digit that could be preserved\n\t\t\t\t\tlet multiplier = mult10[((src[position] & 0x7f) << 1) | (src[position + 1] >> 7)]\n\t\t\t\t\tposition += 4\n\t\t\t\t\treturn ((multiplier * value + (value > 0 ? 0.5 : -0.5)) >> 0) / multiplier\n\t\t\t\t}\n\t\t\t\tposition += 4\n\t\t\t\treturn value\n\t\t\tcase 0xcb:\n\t\t\t\tvalue = dataView.getFloat64(position)\n\t\t\t\tposition += 8\n\t\t\t\treturn value\n\t\t\t// uint handlers\n\t\t\tcase 0xcc:\n\t\t\t\treturn src[position++]\n\t\t\tcase 0xcd:\n\t\t\t\tvalue = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\treturn value\n\t\t\tcase 0xce:\n\t\t\t\tvalue = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\treturn value\n\t\t\tcase 0xcf:\n\t\t\t\tif (currentUnpackr.int64AsType === 'number') {\n\t\t\t\t\tvalue = dataView.getUint32(position) * 0x100000000\n\t\t\t\t\tvalue += dataView.getUint32(position + 4)\n\t\t\t\t} else if (currentUnpackr.int64AsType === 'string') {\n\t\t\t\t\tvalue = dataView.getBigUint64(position).toString()\n\t\t\t\t} else if (currentUnpackr.int64AsType === 'auto') {\n\t\t\t\t\tvalue = dataView.getBigUint64(position)\n\t\t\t\t\tif (value<=BigInt(2)<<BigInt(52)) value=Number(value)\n\t\t\t\t} else\n\t\t\t\t\tvalue = dataView.getBigUint64(position)\n\t\t\t\tposition += 8\n\t\t\t\treturn value\n\n\t\t\t// int handlers\n\t\t\tcase 0xd0:\n\t\t\t\treturn dataView.getInt8(position++)\n\t\t\tcase 0xd1:\n\t\t\t\tvalue = dataView.getInt16(position)\n\t\t\t\tposition += 2\n\t\t\t\treturn value\n\t\t\tcase 0xd2:\n\t\t\t\tvalue = dataView.getInt32(position)\n\t\t\t\tposition += 4\n\t\t\t\treturn value\n\t\t\tcase 0xd3:\n\t\t\t\tif (currentUnpackr.int64AsType === 'number') {\n\t\t\t\t\tvalue = dataView.getInt32(position) * 0x100000000\n\t\t\t\t\tvalue += dataView.getUint32(position + 4)\n\t\t\t\t} else if (currentUnpackr.int64AsType === 'string') {\n\t\t\t\t\tvalue = dataView.getBigInt64(position).toString()\n\t\t\t\t} else if (currentUnpackr.int64AsType === 'auto') {\n\t\t\t\t\tvalue = dataView.getBigInt64(position)\n\t\t\t\t\tif (value>=BigInt(-2)<<BigInt(52)&&value<=BigInt(2)<<BigInt(52)) value=Number(value)\n\t\t\t\t} else\n\t\t\t\t\tvalue = dataView.getBigInt64(position)\n\t\t\t\tposition += 8\n\t\t\t\treturn value\n\n\t\t\tcase 0xd4:\n\t\t\t\t// fixext 1\n\t\t\t\tvalue = src[position++]\n\t\t\t\tif (value == 0x72) {\n\t\t\t\t\treturn recordDefinition(src[position++] & 0x3f)\n\t\t\t\t} else {\n\t\t\t\t\tlet extension = currentExtensions[value]\n\t\t\t\t\tif (extension) {\n\t\t\t\t\t\tif (extension.read) {\n\t\t\t\t\t\t\tposition++ // skip filler byte\n\t\t\t\t\t\t\treturn extension.read(read())\n\t\t\t\t\t\t} else if (extension.noBuffer) {\n\t\t\t\t\t\t\tposition++ // skip filler byte\n\t\t\t\t\t\t\treturn extension()\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\treturn extension(src.subarray(position, ++position))\n\t\t\t\t\t} else\n\t\t\t\t\t\tthrow new Error('Unknown extension ' + value)\n\t\t\t\t}\n\t\t\tcase 0xd5:\n\t\t\t\t// fixext 2\n\t\t\t\tvalue = src[position]\n\t\t\t\tif (value == 0x72) {\n\t\t\t\t\tposition++\n\t\t\t\t\treturn recordDefinition(src[position++] & 0x3f, src[position++])\n\t\t\t\t} else\n\t\t\t\t\treturn readExt(2)\n\t\t\tcase 0xd6:\n\t\t\t\t// fixext 4\n\t\t\t\treturn readExt(4)\n\t\t\tcase 0xd7:\n\t\t\t\t// fixext 8\n\t\t\t\treturn readExt(8)\n\t\t\tcase 0xd8:\n\t\t\t\t// fixext 16\n\t\t\t\treturn readExt(16)\n\t\t\tcase 0xd9:\n\t\t\t// str 8\n\t\t\t\tvalue = src[position++]\n\t\t\t\tif (srcStringEnd >= position) {\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\n\t\t\t\t}\n\t\t\t\treturn readString8(value)\n\t\t\tcase 0xda:\n\t\t\t// str 16\n\t\t\t\tvalue = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\tif (srcStringEnd >= position) {\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\n\t\t\t\t}\n\t\t\t\treturn readString16(value)\n\t\t\tcase 0xdb:\n\t\t\t// str 32\n\t\t\t\tvalue = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\tif (srcStringEnd >= position) {\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\n\t\t\t\t}\n\t\t\t\treturn readString32(value)\n\t\t\tcase 0xdc:\n\t\t\t// array 16\n\t\t\t\tvalue = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\treturn readArray(value)\n\t\t\tcase 0xdd:\n\t\t\t// array 32\n\t\t\t\tvalue = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\treturn readArray(value)\n\t\t\tcase 0xde:\n\t\t\t// map 16\n\t\t\t\tvalue = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\treturn readMap(value)\n\t\t\tcase 0xdf:\n\t\t\t// map 32\n\t\t\t\tvalue = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\treturn readMap(value)\n\t\t\tdefault: // negative int\n\t\t\t\tif (token >= 0xe0)\n\t\t\t\t\treturn token - 0x100\n\t\t\t\tif (token === undefined) {\n\t\t\t\t\tlet error = new Error('Unexpected end of MessagePack data')\n\t\t\t\t\terror.incomplete = true\n\t\t\t\t\tthrow error\n\t\t\t\t}\n\t\t\t\tthrow new Error('Unknown MessagePack token ' + token)\n\n\t\t}\n\t}\n}\nconst validName = /^[a-zA-Z_$][a-zA-Z\\d_$]*$/\nfunction createStructureReader(structure, firstId) {\n\tfunction readObject() {\n\t\t// This initial function is quick to instantiate, but runs slower. After several iterations pay the cost to build the faster function\n\t\tif (readObject.count++ > inlineObjectReadThreshold) {\n\t\t\tlet readObject = structure.read = (new Function('r', 'return function(){return ' + (currentUnpackr.freezeData ? 'Object.freeze' : '') +\n\t\t\t\t'({' + structure.map(key => key === '__proto__' ? '__proto_:r()' : validName.test(key) ? key + ':r()' : ('[' + JSON.stringify(key) + ']:r()')).join(',') + '})}'))(read)\n\t\t\tif (structure.highByte === 0)\n\t\t\t\tstructure.read = createSecondByteReader(firstId, structure.read)\n\t\t\treturn readObject() // second byte is already read, if there is one so immediately read object\n\t\t}\n\t\tlet object = {}\n\t\tfor (let i = 0, l = structure.length; i < l; i++) {\n\t\t\tlet key = structure[i]\n\t\t\tif (key === '__proto__')\n\t\t\t\tkey = '__proto_'\n\t\t\tobject[key] = read()\n\t\t}\n\t\tif (currentUnpackr.freezeData)\n\t\t\treturn Object.freeze(object);\n\t\treturn object\n\t}\n\treadObject.count = 0\n\tif (structure.highByte === 0) {\n\t\treturn createSecondByteReader(firstId, readObject)\n\t}\n\treturn readObject\n}\n\nconst createSecondByteReader = (firstId, read0) => {\n\treturn function() {\n\t\tlet highByte = src[position++]\n\t\tif (highByte === 0)\n\t\t\treturn read0()\n\t\tlet id = firstId < 32 ? -(firstId + (highByte << 5)) : firstId + (highByte << 5)\n\t\tlet structure = currentStructures[id] || loadStructures()[id]\n\t\tif (!structure) {\n\t\t\tthrow new Error('Record id is not defined for ' + id)\n\t\t}\n\t\tif (!structure.read)\n\t\t\tstructure.read = createStructureReader(structure, firstId)\n\t\treturn structure.read()\n\t}\n}\n\nexport function loadStructures() {\n\tlet loadedStructures = saveState(() => {\n\t\t// save the state in case getStructures modifies our buffer\n\t\tsrc = null\n\t\treturn currentUnpackr.getStructures()\n\t})\n\treturn currentStructures = currentUnpackr._mergeStructures(loadedStructures, currentStructures)\n}\n\nvar readFixedString = readStringJS\nvar readString8 = readStringJS\nvar readString16 = readStringJS\nvar readString32 = readStringJS\nexport let isNativeAccelerationEnabled = false\n\nexport function setExtractor(extractStrings) {\n\tisNativeAccelerationEnabled = true\n\treadFixedString = readString(1)\n\treadString8 = readString(2)\n\treadString16 = readString(3)\n\treadString32 = readString(5)\n\tfunction readString(headerLength) {\n\t\treturn function readString(length) {\n\t\t\tlet string = strings[stringPosition++]\n\t\t\tif (string == null) {\n\t\t\t\tif (bundledStrings)\n\t\t\t\t\treturn readStringJS(length)\n\t\t\t\tlet byteOffset = src.byteOffset\n\t\t\t\tlet extraction = extractStrings(position - headerLength + byteOffset, srcEnd + byteOffset, src.buffer)\n\t\t\t\tif (typeof extraction == 'string') {\n\t\t\t\t\tstring = extraction\n\t\t\t\t\tstrings = EMPTY_ARRAY\n\t\t\t\t} else {\n\t\t\t\t\tstrings = extraction\n\t\t\t\t\tstringPosition = 1\n\t\t\t\t\tsrcStringEnd = 1 // even if a utf-8 string was decoded, must indicate we are in the midst of extracted strings and can't skip strings\n\t\t\t\t\tstring = strings[0]\n\t\t\t\t\tif (string === undefined)\n\t\t\t\t\t\tthrow new Error('Unexpected end of buffer')\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet srcStringLength = string.length\n\t\t\tif (srcStringLength <= length) {\n\t\t\t\tposition += length\n\t\t\t\treturn string\n\t\t\t}\n\t\t\tsrcString = string\n\t\t\tsrcStringStart = position\n\t\t\tsrcStringEnd = position + srcStringLength\n\t\t\tposition += length\n\t\t\treturn string.slice(0, length) // we know we just want the beginning\n\t\t}\n\t}\n}\nfunction readStringJS(length) {\n\tlet result\n\tif (length < 16) {\n\t\tif (result = shortStringInJS(length))\n\t\t\treturn result\n\t}\n\tif (length > 64 && decoder)\n\t\treturn decoder.decode(src.subarray(position, position += length))\n\tconst end = position + length\n\tconst units = []\n\tresult = ''\n\twhile (position < end) {\n\t\tconst byte1 = src[position++]\n\t\tif ((byte1 & 0x80) === 0) {\n\t\t\t// 1 byte\n\t\t\tunits.push(byte1)\n\t\t} else if ((byte1 & 0xe0) === 0xc0) {\n\t\t\t// 2 bytes\n\t\t\tconst byte2 = src[position++] & 0x3f\n\t\t\tunits.push(((byte1 & 0x1f) << 6) | byte2)\n\t\t} else if ((byte1 & 0xf0) === 0xe0) {\n\t\t\t// 3 bytes\n\t\t\tconst byte2 = src[position++] & 0x3f\n\t\t\tconst byte3 = src[position++] & 0x3f\n\t\t\tunits.push(((byte1 & 0x1f) << 12) | (byte2 << 6) | byte3)\n\t\t} else if ((byte1 & 0xf8) === 0xf0) {\n\t\t\t// 4 bytes\n\t\t\tconst byte2 = src[position++] & 0x3f\n\t\t\tconst byte3 = src[position++] & 0x3f\n\t\t\tconst byte4 = src[position++] & 0x3f\n\t\t\tlet unit = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0c) | (byte3 << 0x06) | byte4\n\t\t\tif (unit > 0xffff) {\n\t\t\t\tunit -= 0x10000\n\t\t\t\tunits.push(((unit >>> 10) & 0x3ff) | 0xd800)\n\t\t\t\tunit = 0xdc00 | (unit & 0x3ff)\n\t\t\t}\n\t\t\tunits.push(unit)\n\t\t} else {\n\t\t\tunits.push(byte1)\n\t\t}\n\n\t\tif (units.length >= 0x1000) {\n\t\t\tresult += fromCharCode.apply(String, units)\n\t\t\tunits.length = 0\n\t\t}\n\t}\n\n\tif (units.length > 0) {\n\t\tresult += fromCharCode.apply(String, units)\n\t}\n\n\treturn result\n}\nexport function readString(source, start, length) {\n\tlet existingSrc = src;\n\tsrc = source;\n\tposition = start;\n\ttry {\n\t\treturn readStringJS(length);\n\t} finally {\n\t\tsrc = existingSrc;\n\t}\n}\n\nfunction readArray(length) {\n\tlet array = new Array(length)\n\tfor (let i = 0; i < length; i++) {\n\t\tarray[i] = read()\n\t}\n\tif (currentUnpackr.freezeData)\n\t\treturn Object.freeze(array)\n\treturn array\n}\n\nfunction readMap(length) {\n\tif (currentUnpackr.mapsAsObjects) {\n\t\tlet object = {}\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tlet key = readKey()\n\t\t\tif (key === '__proto__')\n\t\t\t\tkey = '__proto_';\n\t\t\tobject[key] = read()\n\t\t}\n\t\treturn object\n\t} else {\n\t\tlet map = new Map()\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tmap.set(read(), read())\n\t\t}\n\t\treturn map\n\t}\n}\n\nvar fromCharCode = String.fromCharCode\nfunction longStringInJS(length) {\n\tlet start = position\n\tlet bytes = new Array(length)\n\tfor (let i = 0; i < length; i++) {\n\t\tconst byte = src[position++];\n\t\tif ((byte & 0x80) > 0) {\n\t\t\t\tposition = start\n\t\t\t\treturn\n\t\t\t}\n\t\t\tbytes[i] = byte\n\t\t}\n\t\treturn fromCharCode.apply(String, bytes)\n}\nfunction shortStringInJS(length) {\n\tif (length < 4) {\n\t\tif (length < 2) {\n\t\t\tif (length === 0)\n\t\t\t\treturn ''\n\t\t\telse {\n\t\t\t\tlet a = src[position++]\n\t\t\t\tif ((a & 0x80) > 1) {\n\t\t\t\t\tposition -= 1\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn fromCharCode(a)\n\t\t\t}\n\t\t} else {\n\t\t\tlet a = src[position++]\n\t\t\tlet b = src[position++]\n\t\t\tif ((a & 0x80) > 0 || (b & 0x80) > 0) {\n\t\t\t\tposition -= 2\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (length < 3)\n\t\t\t\treturn fromCharCode(a, b)\n\t\t\tlet c = src[position++]\n\t\t\tif ((c & 0x80) > 0) {\n\t\t\t\tposition -= 3\n\t\t\t\treturn\n\t\t\t}\n\t\t\treturn fromCharCode(a, b, c)\n\t\t}\n\t} else {\n\t\tlet a = src[position++]\n\t\tlet b = src[position++]\n\t\tlet c = src[position++]\n\t\tlet d = src[position++]\n\t\tif ((a & 0x80) > 0 || (b & 0x80) > 0 || (c & 0x80) > 0 || (d & 0x80) > 0) {\n\t\t\tposition -= 4\n\t\t\treturn\n\t\t}\n\t\tif (length < 6) {\n\t\t\tif (length === 4)\n\t\t\t\treturn fromCharCode(a, b, c, d)\n\t\t\telse {\n\t\t\t\tlet e = src[position++]\n\t\t\t\tif ((e & 0x80) > 0) {\n\t\t\t\t\tposition -= 5\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn fromCharCode(a, b, c, d, e)\n\t\t\t}\n\t\t} else if (length < 8) {\n\t\t\tlet e = src[position++]\n\t\t\tlet f = src[position++]\n\t\t\tif ((e & 0x80) > 0 || (f & 0x80) > 0) {\n\t\t\t\tposition -= 6\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (length < 7)\n\t\t\t\treturn fromCharCode(a, b, c, d, e, f)\n\t\t\tlet g = src[position++]\n\t\t\tif ((g & 0x80) > 0) {\n\t\t\t\tposition -= 7\n\t\t\t\treturn\n\t\t\t}\n\t\t\treturn fromCharCode(a, b, c, d, e, f, g)\n\t\t} else {\n\t\t\tlet e = src[position++]\n\t\t\tlet f = src[position++]\n\t\t\tlet g = src[position++]\n\t\t\tlet h = src[position++]\n\t\t\tif ((e & 0x80) > 0 || (f & 0x80) > 0 || (g & 0x80) > 0 || (h & 0x80) > 0) {\n\t\t\t\tposition -= 8\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (length < 10) {\n\t\t\t\tif (length === 8)\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h)\n\t\t\t\telse {\n\t\t\t\t\tlet i = src[position++]\n\t\t\t\t\tif ((i & 0x80) > 0) {\n\t\t\t\t\t\tposition -= 9\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i)\n\t\t\t\t}\n\t\t\t} else if (length < 12) {\n\t\t\t\tlet i = src[position++]\n\t\t\t\tlet j = src[position++]\n\t\t\t\tif ((i & 0x80) > 0 || (j & 0x80) > 0) {\n\t\t\t\t\tposition -= 10\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (length < 11)\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j)\n\t\t\t\tlet k = src[position++]\n\t\t\t\tif ((k & 0x80) > 0) {\n\t\t\t\t\tposition -= 11\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k)\n\t\t\t} else {\n\t\t\t\tlet i = src[position++]\n\t\t\t\tlet j = src[position++]\n\t\t\t\tlet k = src[position++]\n\t\t\t\tlet l = src[position++]\n\t\t\t\tif ((i & 0x80) > 0 || (j & 0x80) > 0 || (k & 0x80) > 0 || (l & 0x80) > 0) {\n\t\t\t\t\tposition -= 12\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (length < 14) {\n\t\t\t\t\tif (length === 12)\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l)\n\t\t\t\t\telse {\n\t\t\t\t\t\tlet m = src[position++]\n\t\t\t\t\t\tif ((m & 0x80) > 0) {\n\t\t\t\t\t\t\tposition -= 13\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlet m = src[position++]\n\t\t\t\t\tlet n = src[position++]\n\t\t\t\t\tif ((m & 0x80) > 0 || (n & 0x80) > 0) {\n\t\t\t\t\t\tposition -= 14\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tif (length < 15)\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m, n)\n\t\t\t\t\tlet o = src[position++]\n\t\t\t\t\tif ((o & 0x80) > 0) {\n\t\t\t\t\t\tposition -= 15\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction readOnlyJSString() {\n\tlet token = src[position++]\n\tlet length\n\tif (token < 0xc0) {\n\t\t// fixstr\n\t\tlength = token - 0xa0\n\t} else {\n\t\tswitch(token) {\n\t\t\tcase 0xd9:\n\t\t\t// str 8\n\t\t\t\tlength = src[position++]\n\t\t\t\tbreak\n\t\t\tcase 0xda:\n\t\t\t// str 16\n\t\t\t\tlength = dataView.getUint16(position)\n\t\t\t\tposition += 2\n\t\t\t\tbreak\n\t\t\tcase 0xdb:\n\t\t\t// str 32\n\t\t\t\tlength = dataView.getUint32(position)\n\t\t\t\tposition += 4\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tthrow new Error('Expected string')\n\t\t}\n\t}\n\treturn readStringJS(length)\n}\n\n\nfunction readBin(length) {\n\treturn currentUnpackr.copyBuffers ?\n\t\t// specifically use the copying slice (not the node one)\n\t\tUint8Array.prototype.slice.call(src, position, position += length) :\n\t\tsrc.subarray(position, position += length)\n}\nfunction readExt(length) {\n\tlet type = src[position++]\n\tif (currentExtensions[type]) {\n\t\tlet end\n\t\treturn currentExtensions[type](src.subarray(position, end = (position += length)), (readPosition) => {\n\t\t\tposition = readPosition;\n\t\t\ttry {\n\t\t\t\treturn read();\n\t\t\t} finally {\n\t\t\t\tposition = end;\n\t\t\t}\n\t\t})\n\t}\n\telse\n\t\tthrow new Error('Unknown extension type ' + type)\n}\n\nvar keyCache = new Array(4096)\nfunction readKey() {\n\tlet length = src[position++]\n\tif (length >= 0xa0 && length < 0xc0) {\n\t\t// fixstr, potentially use key cache\n\t\tlength = length - 0xa0\n\t\tif (srcStringEnd >= position) // if it has been extracted, must use it (and faster anyway)\n\t\t\treturn srcString.slice(position - srcStringStart, (position += length) - srcStringStart)\n\t\telse if (!(srcStringEnd == 0 && srcEnd < 180))\n\t\t\treturn readFixedString(length)\n\t} else { // not cacheable, go back and do a standard read\n\t\tposition--\n\t\treturn asSafeString(read())\n\t}\n\tlet key = ((length << 5) ^ (length > 1 ? dataView.getUint16(position) : length > 0 ? src[position] : 0)) & 0xfff\n\tlet entry = keyCache[key]\n\tlet checkPosition = position\n\tlet end = position + length - 3\n\tlet chunk\n\tlet i = 0\n\tif (entry && entry.bytes == length) {\n\t\twhile (checkPosition < end) {\n\t\t\tchunk = dataView.getUint32(checkPosition)\n\t\t\tif (chunk != entry[i++]) {\n\t\t\t\tcheckPosition = 0x70000000\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcheckPosition += 4\n\t\t}\n\t\tend += 3\n\t\twhile (checkPosition < end) {\n\t\t\tchunk = src[checkPosition++]\n\t\t\tif (chunk != entry[i++]) {\n\t\t\t\tcheckPosition = 0x70000000\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\tif (checkPosition === end) {\n\t\t\tposition = checkPosition\n\t\t\treturn entry.string\n\t\t}\n\t\tend -= 3\n\t\tcheckPosition = position\n\t}\n\tentry = []\n\tkeyCache[key] = entry\n\tentry.bytes = length\n\twhile (checkPosition < end) {\n\t\tchunk = dataView.getUint32(checkPosition)\n\t\tentry.push(chunk)\n\t\tcheckPosition += 4\n\t}\n\tend += 3\n\twhile (checkPosition < end) {\n\t\tchunk = src[checkPosition++]\n\t\tentry.push(chunk)\n\t}\n\t// for small blocks, avoiding the overhead of the extract call is helpful\n\tlet string = length < 16 ? shortStringInJS(length) : longStringInJS(length)\n\tif (string != null)\n\t\treturn entry.string = string\n\treturn entry.string = readFixedString(length)\n}\n\nfunction asSafeString(property) {\n\t// protect against expensive (DoS) string conversions\n\tif (typeof property === 'string') return property;\n\tif (typeof property === 'number' || typeof property === 'boolean' || typeof property === 'bigint') return property.toString();\n\tif (property == null) return property + '';\n\tif (currentUnpackr.allowArraysInMapKeys && Array.isArray(property) && property.flat().every(item => ['string', 'number', 'boolean', 'bigint'].includes(typeof item))) {\n\t\treturn property.flat().toString();\n\t}\n\tthrow new Error(`Invalid property type for record: ${typeof property}`);\n}\n// the registration of the record definition extension (as \"r\")\nconst recordDefinition = (id, highByte) => {\n\tlet structure = read().map(asSafeString) // ensure that all keys are strings and\n\t// that the array is mutable\n\tlet firstByte = id\n\tif (highByte !== undefined) {\n\t\tid = id < 32 ? -((highByte << 5) + id) : ((highByte << 5) + id)\n\t\tstructure.highByte = highByte\n\t}\n\tlet existingStructure = currentStructures[id]\n\t// If it is a shared structure, we need to restore any changes after reading.\n\t// Also in sequential mode, we may get incomplete reads and thus errors, and we need to restore\n\t// to the state prior to an incomplete read in order to properly resume.\n\tif (existingStructure && (existingStructure.isShared || sequentialMode)) {\n\t\t(currentStructures.restoreStructures || (currentStructures.restoreStructures = []))[id] = existingStructure\n\t}\n\tcurrentStructures[id] = structure\n\tstructure.read = createStructureReader(structure, firstByte)\n\treturn structure.read()\n}\ncurrentExtensions[0] = () => {} // notepack defines extension 0 to mean undefined, so use that as the default here\ncurrentExtensions[0].noBuffer = true\n\ncurrentExtensions[0x42] = (data) => {\n\t// decode bigint\n\tlet length = data.length;\n\tlet value = BigInt(data[0] & 0x80 ? data[0] - 0x100 : data[0]);\n\tfor (let i = 1; i < length; i++) {\n\t\tvalue <<= BigInt(8);\n\t\tvalue += BigInt(data[i]);\n\t}\n\treturn value;\n}\n\nlet errors = { Error, TypeError, ReferenceError };\ncurrentExtensions[0x65] = () => {\n\tlet data = read()\n\treturn (errors[data[0]] || Error)(data[1], { cause: data[2] })\n}\n\ncurrentExtensions[0x69] = (data) => {\n\t// id extension (for structured clones)\n\tif (currentUnpackr.structuredClone === false) throw new Error('Structured clone extension is disabled')\n\tlet id = dataView.getUint32(position - 4)\n\tif (!referenceMap)\n\t\treferenceMap = new Map()\n\tlet token = src[position]\n\tlet target\n\t// TODO: handle Maps, Sets, and other types that can cycle; this is complicated, because you potentially need to read\n\t// ahead past references to record structure definitions\n\tif (token >= 0x90 && token < 0xa0 || token == 0xdc || token == 0xdd)\n\t\ttarget = []\n\telse\n\t\ttarget = {}\n\n\tlet refEntry = { target } // a placeholder object\n\treferenceMap.set(id, refEntry)\n\tlet targetProperties = read() // read the next value as the target object to id\n\tif (refEntry.used) // there is a cycle, so we have to assign properties to original target\n\t\treturn Object.assign(target, targetProperties)\n\trefEntry.target = targetProperties // the placeholder wasn't used, replace with the deserialized one\n\treturn targetProperties // no cycle, can just use the returned read object\n}\n\ncurrentExtensions[0x70] = (data) => {\n\t// pointer extension (for structured clones)\n\tif (currentUnpackr.structuredClone === false) throw new Error('Structured clone extension is disabled')\n\tlet id = dataView.getUint32(position - 4)\n\tlet refEntry = referenceMap.get(id)\n\trefEntry.used = true\n\treturn refEntry.target\n}\n\ncurrentExtensions[0x73] = () => new Set(read())\n\nexport const typedArrays = ['Int8','Uint8','Uint8Clamped','Int16','Uint16','Int32','Uint32','Float32','Float64','BigInt64','BigUint64'].map(type => type + 'Array')\n\nlet glbl = typeof globalThis === 'object' ? globalThis : window;\ncurrentExtensions[0x74] = (data) => {\n\tlet typeCode = data[0]\n\tlet typedArrayName = typedArrays[typeCode]\n\tif (!typedArrayName) {\n\t\tif (typeCode === 16) {\n\t\t\tlet ab = new ArrayBuffer(data.length - 1)\n\t\t\tlet u8 = new Uint8Array(ab)\n\t\t\tu8.set(data.subarray(1))\n\t\t\treturn ab;\n\t\t}\n\t\tthrow new Error('Could not find typed array for code ' + typeCode)\n\t}\n\t// we have to always slice/copy here to get a new ArrayBuffer that is word/byte aligned\n\treturn new glbl[typedArrayName](Uint8Array.prototype.slice.call(data, 1).buffer)\n}\ncurrentExtensions[0x78] = () => {\n\tlet data = read()\n\treturn new RegExp(data[0], data[1])\n}\nconst TEMP_BUNDLE = []\ncurrentExtensions[0x62] = (data) => {\n\tlet dataSize = (data[0] << 24) + (data[1] << 16) + (data[2] << 8) + data[3]\n\tlet dataPosition = position\n\tposition += dataSize - data.length\n\tbundledStrings = TEMP_BUNDLE\n\tbundledStrings = [readOnlyJSString(), readOnlyJSString()]\n\tbundledStrings.position0 = 0\n\tbundledStrings.position1 = 0\n\tbundledStrings.postBundlePosition = position\n\tposition = dataPosition\n\treturn read()\n}\n\ncurrentExtensions[0xff] = (data) => {\n\t// 32-bit date extension\n\tif (data.length == 4)\n\t\treturn new Date((data[0] * 0x1000000 + (data[1] << 16) + (data[2] << 8) + data[3]) * 1000)\n\telse if (data.length == 8)\n\t\treturn new Date(\n\t\t\t((data[0] << 22) + (data[1] << 14) + (data[2] << 6) + (data[3] >> 2)) / 1000000 +\n\t\t\t((data[3] & 0x3) * 0x100000000 + data[4] * 0x1000000 + (data[5] << 16) + (data[6] << 8) + data[7]) * 1000)\n\telse if (data.length == 12)// TODO: Implement support for negative\n\t\treturn new Date(\n\t\t\t((data[0] << 24) + (data[1] << 16) + (data[2] << 8) + data[3]) / 1000000 +\n\t\t\t(((data[4] & 0x80) ? -0x1000000000000 : 0) + data[6] * 0x10000000000 + data[7] * 0x100000000 + data[8] * 0x1000000 + (data[9] << 16) + (data[10] << 8) + data[11]) * 1000)\n\telse\n\t\treturn new Date('invalid')\n} // notepack defines extension 0 to mean undefined, so use that as the default here\n// registration of bulk record definition?\n// currentExtensions[0x52] = () =>\n\nfunction saveState(callback) {\n\tif (onSaveState)\n\t\tonSaveState();\n\tlet savedSrcEnd = srcEnd\n\tlet savedPosition = position\n\tlet savedStringPosition = stringPosition\n\tlet savedSrcStringStart = srcStringStart\n\tlet savedSrcStringEnd = srcStringEnd\n\tlet savedSrcString = srcString\n\tlet savedStrings = strings\n\tlet savedReferenceMap = referenceMap\n\tlet savedBundledStrings = bundledStrings\n\n\t// TODO: We may need to revisit this if we do more external calls to user code (since it could be slow)\n\tlet savedSrc = new Uint8Array(src.slice(0, srcEnd)) // we copy the data in case it changes while external data is processed\n\tlet savedStructures = currentStructures\n\tlet savedStructuresContents = currentStructures.slice(0, currentStructures.length)\n\tlet savedPackr = currentUnpackr\n\tlet savedSequentialMode = sequentialMode\n\tlet value = callback()\n\tsrcEnd = savedSrcEnd\n\tposition = savedPosition\n\tstringPosition = savedStringPosition\n\tsrcStringStart = savedSrcStringStart\n\tsrcStringEnd = savedSrcStringEnd\n\tsrcString = savedSrcString\n\tstrings = savedStrings\n\treferenceMap = savedReferenceMap\n\tbundledStrings = savedBundledStrings\n\tsrc = savedSrc\n\tsequentialMode = savedSequentialMode\n\tcurrentStructures = savedStructures\n\tcurrentStructures.splice(0, currentStructures.length, ...savedStructuresContents)\n\tcurrentUnpackr = savedPackr\n\tdataView = new DataView(src.buffer, src.byteOffset, src.byteLength)\n\treturn value\n}\nexport function clearSource() {\n\tsrc = null\n\treferenceMap = null\n\tcurrentStructures = null\n}\n\nexport function addExtension(extension) {\n\tif (extension.unpack)\n\t\tcurrentExtensions[extension.type] = extension.unpack\n\telse\n\t\tcurrentExtensions[extension.type] = extension\n}\n\nexport const mult10 = new Array(147) // this is a table matching binary exponents to the multiplier to determine significant digit rounding\nfor (let i = 0; i < 256; i++) {\n\tmult10[i] = +('1e' + Math.floor(45.15 - i * 0.30103))\n}\nexport const Decoder = Unpackr\nvar defaultUnpackr = new Unpackr({ useRecords: false })\nexport const unpack = defaultUnpackr.unpack\nexport const unpackMultiple = defaultUnpackr.unpackMultiple\nexport const decode = defaultUnpackr.unpack\nexport const FLOAT32_OPTIONS = {\n\tNEVER: 0,\n\tALWAYS: 1,\n\tDECIMAL_ROUND: 3,\n\tDECIMAL_FIT: 4\n}\nlet f32Array = new Float32Array(1)\nlet u8Array = new Uint8Array(f32Array.buffer, 0, 4)\nexport function roundFloat32(float32Number) {\n\tf32Array[0] = float32Number\n\tlet multiplier = mult10[((u8Array[3] & 0x7f) << 1) | (u8Array[2] >> 7)]\n\treturn ((multiplier * float32Number + (float32Number > 0 ? 0.5 : -0.5)) >> 0) / multiplier\n}\nexport function setReadStruct(updatedReadStruct, loadedStructs, saveState) {\n\treadStruct = updatedReadStruct;\n\tonLoadedStructures = loadedStructs;\n\tonSaveState = saveState;\n}\n", "import { Unpackr, mult10, C1Type, typedArrays, addExtension as unpackAddExtension } from './unpack.js'\nlet textEncoder\ntry {\n\ttextEncoder = new TextEncoder()\n} catch (error) {}\nlet extensions, extensionClasses\nconst hasNodeBuffer = typeof Buffer !== 'undefined'\nconst ByteArrayAllocate = hasNodeBuffer ?\n\tfunction(length) { return Buffer.allocUnsafeSlow(length) } : Uint8Array\nconst ByteArray = hasNodeBuffer ? Buffer : Uint8Array\nconst MAX_BUFFER_SIZE = hasNodeBuffer ? 0x100000000 : 0x7fd00000\nlet target, keysTarget\nlet targetView\nlet position = 0\nlet safeEnd\nlet bundledStrings = null\nlet writeStructSlots\nconst MAX_BUNDLE_SIZE = 0x5500 // maximum characters such that the encoded bytes fits in 16 bits.\nconst hasNonLatin = /[\\u0080-\\uFFFF]/\nexport const RECORD_SYMBOL = Symbol('record-id')\nexport class Packr extends Unpackr {\n\tconstructor(options) {\n\t\tsuper(options)\n\t\tthis.offset = 0\n\t\tlet typeBuffer\n\t\tlet start\n\t\tlet hasSharedUpdate\n\t\tlet structures\n\t\tlet referenceMap\n\t\tlet encodeUtf8 = ByteArray.prototype.utf8Write ? function(string, position) {\n\t\t\treturn target.utf8Write(string, position, target.byteLength - position)\n\t\t} : (textEncoder && textEncoder.encodeInto) ?\n\t\t\tfunction(string, position) {\n\t\t\t\treturn textEncoder.encodeInto(string, target.subarray(position)).written\n\t\t\t} : false\n\n\t\tlet packr = this\n\t\tif (!options)\n\t\t\toptions = {}\n\t\tlet isSequential = options && options.sequential\n\t\tlet hasSharedStructures = options.structures || options.saveStructures\n\t\tlet maxSharedStructures = options.maxSharedStructures\n\t\tif (maxSharedStructures == null)\n\t\t\tmaxSharedStructures = hasSharedStructures ? 32 : 0\n\t\tif (maxSharedStructures > 8160)\n\t\t\tthrow new Error('Maximum maxSharedStructure is 8160')\n\t\tif (options.structuredClone && options.moreTypes == undefined) {\n\t\t\tthis.moreTypes = true\n\t\t}\n\t\tlet maxOwnStructures = options.maxOwnStructures\n\t\tif (maxOwnStructures == null)\n\t\t\tmaxOwnStructures = hasSharedStructures ? 32 : 64\n\t\tif (!this.structures && options.useRecords != false)\n\t\t\tthis.structures = []\n\t\t// two byte record ids for shared structures\n\t\tlet useTwoByteRecords = maxSharedStructures > 32 || (maxOwnStructures + maxSharedStructures > 64)\n\t\tlet sharedLimitId = maxSharedStructures + 0x40\n\t\tlet maxStructureId = maxSharedStructures + maxOwnStructures + 0x40\n\t\tif (maxStructureId > 8256) {\n\t\t\tthrow new Error('Maximum maxSharedStructure + maxOwnStructure is 8192')\n\t\t}\n\t\tlet recordIdsToRemove = []\n\t\tlet transitionsCount = 0\n\t\tlet serializationsSinceTransitionRebuild = 0\n\n\t\tthis.pack = this.encode = function(value, encodeOptions) {\n\t\t\tif (!target) {\n\t\t\t\ttarget = new ByteArrayAllocate(8192)\n\t\t\t\ttargetView = target.dataView || (target.dataView = new DataView(target.buffer, 0, 8192))\n\t\t\t\tposition = 0\n\t\t\t}\n\t\t\tsafeEnd = target.length - 10\n\t\t\tif (safeEnd - position < 0x800) {\n\t\t\t\t// don't start too close to the end,\n\t\t\t\ttarget = new ByteArrayAllocate(target.length)\n\t\t\t\ttargetView = target.dataView || (target.dataView = new DataView(target.buffer, 0, target.length))\n\t\t\t\tsafeEnd = target.length - 10\n\t\t\t\tposition = 0\n\t\t\t} else\n\t\t\t\tposition = (position + 7) & 0x7ffffff8 // Word align to make any future copying of this buffer faster\n\t\t\tstart = position\n\t\t\tif (encodeOptions & RESERVE_START_SPACE) position += (encodeOptions & 0xff)\n\t\t\treferenceMap = packr.structuredClone ? new Map() : null\n\t\t\tif (packr.bundleStrings && typeof value !== 'string') {\n\t\t\t\tbundledStrings = []\n\t\t\t\tbundledStrings.size = Infinity // force a new bundle start on first string\n\t\t\t} else\n\t\t\t\tbundledStrings = null\n\t\t\tstructures = packr.structures\n\t\t\tif (structures) {\n\t\t\t\tif (structures.uninitialized)\n\t\t\t\t\tstructures = packr._mergeStructures(packr.getStructures())\n\t\t\t\tlet sharedLength = structures.sharedLength || 0\n\t\t\t\tif (sharedLength > maxSharedStructures) {\n\t\t\t\t\t//if (maxSharedStructures <= 32 && structures.sharedLength > 32) // TODO: could support this, but would need to update the limit ids\n\t\t\t\t\tthrow new Error('Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to ' + structures.sharedLength)\n\t\t\t\t}\n\t\t\t\tif (!structures.transitions) {\n\t\t\t\t\t// rebuild our structure transitions\n\t\t\t\t\tstructures.transitions = Object.create(null)\n\t\t\t\t\tfor (let i = 0; i < sharedLength; i++) {\n\t\t\t\t\t\tlet keys = structures[i]\n\t\t\t\t\t\tif (!keys)\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\tlet nextTransition, transition = structures.transitions\n\t\t\t\t\t\tfor (let j = 0, l = keys.length; j < l; j++) {\n\t\t\t\t\t\t\tlet key = keys[j]\n\t\t\t\t\t\t\tnextTransition = transition[key]\n\t\t\t\t\t\t\tif (!nextTransition) {\n\t\t\t\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttransition = nextTransition\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttransition[RECORD_SYMBOL] = i + 0x40\n\t\t\t\t\t}\n\t\t\t\t\tthis.lastNamedStructuresLength = sharedLength\n\t\t\t\t}\n\t\t\t\tif (!isSequential) {\n\t\t\t\t\tstructures.nextId = sharedLength + 0x40\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasSharedUpdate)\n\t\t\t\thasSharedUpdate = false\n\t\t\tlet encodingError;\n\t\t\ttry {\n\t\t\t\tif (packr.randomAccessStructure && value && value.constructor && value.constructor === Object)\n\t\t\t\t\twriteStruct(value);\n\t\t\t\telse\n\t\t\t\t\tpack(value)\n\t\t\t\tlet lastBundle = bundledStrings;\n\t\t\t\tif (bundledStrings)\n\t\t\t\t\twriteBundles(start, pack, 0)\n\t\t\t\tif (referenceMap && referenceMap.idsToInsert) {\n\t\t\t\t\tlet idsToInsert = referenceMap.idsToInsert.sort((a, b) => a.offset > b.offset ? 1 : -1);\n\t\t\t\t\tlet i = idsToInsert.length;\n\t\t\t\t\tlet incrementPosition = -1;\n\t\t\t\t\twhile (lastBundle && i > 0) {\n\t\t\t\t\t\tlet insertionPoint = idsToInsert[--i].offset + start;\n\t\t\t\t\t\tif (insertionPoint < (lastBundle.stringsPosition + start) && incrementPosition === -1)\n\t\t\t\t\t\t\tincrementPosition = 0;\n\t\t\t\t\t\tif (insertionPoint > (lastBundle.position + start)) {\n\t\t\t\t\t\t\tif (incrementPosition >= 0)\n\t\t\t\t\t\t\t\tincrementPosition += 6;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (incrementPosition >= 0) {\n\t\t\t\t\t\t\t\t// update the bundle reference now\n\t\t\t\t\t\t\t\ttargetView.setUint32(lastBundle.position + start,\n\t\t\t\t\t\t\t\t\ttargetView.getUint32(lastBundle.position + start) + incrementPosition)\n\t\t\t\t\t\t\t\tincrementPosition = -1; // reset\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlastBundle = lastBundle.previous;\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (incrementPosition >= 0 && lastBundle) {\n\t\t\t\t\t\t// update the bundle reference now\n\t\t\t\t\t\ttargetView.setUint32(lastBundle.position + start,\n\t\t\t\t\t\t\ttargetView.getUint32(lastBundle.position + start) + incrementPosition)\n\t\t\t\t\t}\n\t\t\t\t\tposition += idsToInsert.length * 6;\n\t\t\t\t\tif (position > safeEnd)\n\t\t\t\t\t\tmakeRoom(position)\n\t\t\t\t\tpackr.offset = position\n\t\t\t\t\tlet serialized = insertIds(target.subarray(start, position), idsToInsert)\n\t\t\t\t\treferenceMap = null\n\t\t\t\t\treturn serialized\n\t\t\t\t}\n\t\t\t\tpackr.offset = position // update the offset so next serialization doesn't write over our buffer, but can continue writing to same buffer sequentially\n\t\t\t\tif (encodeOptions & REUSE_BUFFER_MODE) {\n\t\t\t\t\ttarget.start = start\n\t\t\t\t\ttarget.end = position\n\t\t\t\t\treturn target\n\t\t\t\t}\n\t\t\t\treturn target.subarray(start, position) // position can change if we call pack again in saveStructures, so we get the buffer now\n\t\t\t} catch(error) {\n\t\t\t\tencodingError = error;\n\t\t\t\tthrow error;\n\t\t\t} finally {\n\t\t\t\tif (structures) {\n\t\t\t\t\tresetStructures();\n\t\t\t\t\tif (hasSharedUpdate && packr.saveStructures) {\n\t\t\t\t\t\tlet sharedLength = structures.sharedLength || 0\n\t\t\t\t\t\t// we can't rely on start/end with REUSE_BUFFER_MODE since they will (probably) change when we save\n\t\t\t\t\t\tlet returnBuffer = target.subarray(start, position)\n\t\t\t\t\t\tlet newSharedData = prepareStructures(structures, packr);\n\t\t\t\t\t\tif (!encodingError) { // TODO: If there is an encoding error, should make the structures as uninitialized so they get rebuilt next time\n\t\t\t\t\t\t\tif (packr.saveStructures(newSharedData, newSharedData.isCompatible) === false) {\n\t\t\t\t\t\t\t\t// get updated structures and try again if the update failed\n\t\t\t\t\t\t\t\treturn packr.pack(value, encodeOptions)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpackr.lastNamedStructuresLength = sharedLength\n\t\t\t\t\t\t\t// don't keep large buffers around\n\t\t\t\t\t\t\tif (target.length > 0x40000000) target = null\n\t\t\t\t\t\t\treturn returnBuffer\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// don't keep large buffers around, they take too much memory and cause problems (limit at 1GB)\n\t\t\t\tif (target.length > 0x40000000) target = null\n\t\t\t\tif (encodeOptions & RESET_BUFFER_MODE)\n\t\t\t\t\tposition = start\n\t\t\t}\n\t\t}\n\t\tconst resetStructures = () => {\n\t\t\tif (serializationsSinceTransitionRebuild < 10)\n\t\t\t\tserializationsSinceTransitionRebuild++\n\t\t\tlet sharedLength = structures.sharedLength || 0\n\t\t\tif (structures.length > sharedLength && !isSequential)\n\t\t\t\tstructures.length = sharedLength\n\t\t\tif (transitionsCount > 10000) {\n\t\t\t\t// force a rebuild occasionally after a lot of transitions so it can get cleaned up\n\t\t\t\tstructures.transitions = null\n\t\t\t\tserializationsSinceTransitionRebuild = 0\n\t\t\t\ttransitionsCount = 0\n\t\t\t\tif (recordIdsToRemove.length > 0)\n\t\t\t\t\trecordIdsToRemove = []\n\t\t\t} else if (recordIdsToRemove.length > 0 && !isSequential) {\n\t\t\t\tfor (let i = 0, l = recordIdsToRemove.length; i < l; i++) {\n\t\t\t\t\trecordIdsToRemove[i][RECORD_SYMBOL] = 0\n\t\t\t\t}\n\t\t\t\trecordIdsToRemove = []\n\t\t\t}\n\t\t}\n\t\tconst packArray = (value) => {\n\t\t\tvar length = value.length\n\t\t\tif (length < 0x10) {\n\t\t\t\ttarget[position++] = 0x90 | length\n\t\t\t} else if (length < 0x10000) {\n\t\t\t\ttarget[position++] = 0xdc\n\t\t\t\ttarget[position++] = length >> 8\n\t\t\t\ttarget[position++] = length & 0xff\n\t\t\t} else {\n\t\t\t\ttarget[position++] = 0xdd\n\t\t\t\ttargetView.setUint32(position, length)\n\t\t\t\tposition += 4\n\t\t\t}\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tpack(value[i])\n\t\t\t}\n\t\t}\n\t\tconst pack = (value) => {\n\t\t\tif (position > safeEnd)\n\t\t\t\ttarget = makeRoom(position)\n\n\t\t\tvar type = typeof value\n\t\t\tvar length\n\t\t\tif (type === 'string') {\n\t\t\t\tlet strLength = value.length\n\t\t\t\tif (bundledStrings && strLength >= 4 && strLength < 0x1000) {\n\t\t\t\t\tif ((bundledStrings.size += strLength) > MAX_BUNDLE_SIZE) {\n\t\t\t\t\t\tlet extStart\n\t\t\t\t\t\tlet maxBytes = (bundledStrings[0] ? bundledStrings[0].length * 3 + bundledStrings[1].length : 0) + 10\n\t\t\t\t\t\tif (position + maxBytes > safeEnd)\n\t\t\t\t\t\t\ttarget = makeRoom(position + maxBytes)\n\t\t\t\t\t\tlet lastBundle\n\t\t\t\t\t\tif (bundledStrings.position) { // here we use the 0x62 extension to write the last bundle and reserve space for the reference pointer to the next/current bundle\n\t\t\t\t\t\t\tlastBundle = bundledStrings\n\t\t\t\t\t\t\ttarget[position] = 0xc8 // ext 16\n\t\t\t\t\t\t\tposition += 3 // reserve for the writing bundle size\n\t\t\t\t\t\t\ttarget[position++] = 0x62 // 'b'\n\t\t\t\t\t\t\textStart = position - start\n\t\t\t\t\t\t\tposition += 4 // reserve for writing bundle reference\n\t\t\t\t\t\t\twriteBundles(start, pack, 0) // write the last bundles\n\t\t\t\t\t\t\ttargetView.setUint16(extStart + start - 3, position - start - extStart)\n\t\t\t\t\t\t} else { // here we use the 0x62 extension just to reserve the space for the reference pointer to the bundle (will be updated once the bundle is written)\n\t\t\t\t\t\t\ttarget[position++] = 0xd6 // fixext 4\n\t\t\t\t\t\t\ttarget[position++] = 0x62 // 'b'\n\t\t\t\t\t\t\textStart = position - start\n\t\t\t\t\t\t\tposition += 4 // reserve for writing bundle reference\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbundledStrings = ['', ''] // create new ones\n\t\t\t\t\t\tbundledStrings.previous = lastBundle;\n\t\t\t\t\t\tbundledStrings.size = 0\n\t\t\t\t\t\tbundledStrings.position = extStart\n\t\t\t\t\t}\n\t\t\t\t\tlet twoByte = hasNonLatin.test(value)\n\t\t\t\t\tbundledStrings[twoByte ? 0 : 1] += value\n\t\t\t\t\ttarget[position++] = 0xc1\n\t\t\t\t\tpack(twoByte ? -strLength : strLength);\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tlet headerSize\n\t\t\t\t// first we estimate the header size, so we can write to the correct location\n\t\t\t\tif (strLength < 0x20) {\n\t\t\t\t\theaderSize = 1\n\t\t\t\t} else if (strLength < 0x100) {\n\t\t\t\t\theaderSize = 2\n\t\t\t\t} else if (strLength < 0x10000) {\n\t\t\t\t\theaderSize = 3\n\t\t\t\t} else {\n\t\t\t\t\theaderSize = 5\n\t\t\t\t}\n\t\t\t\tlet maxBytes = strLength * 3\n\t\t\t\tif (position + maxBytes > safeEnd)\n\t\t\t\t\ttarget = makeRoom(position + maxBytes)\n\n\t\t\t\tif (strLength < 0x40 || !encodeUtf8) {\n\t\t\t\t\tlet i, c1, c2, strPosition = position + headerSize\n\t\t\t\t\tfor (i = 0; i < strLength; i++) {\n\t\t\t\t\t\tc1 = value.charCodeAt(i)\n\t\t\t\t\t\tif (c1 < 0x80) {\n\t\t\t\t\t\t\ttarget[strPosition++] = c1\n\t\t\t\t\t\t} else if (c1 < 0x800) {\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 | 0xc0\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t(c1 & 0xfc00) === 0xd800 &&\n\t\t\t\t\t\t\t((c2 = value.charCodeAt(i + 1)) & 0xfc00) === 0xdc00\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tc1 = 0x10000 + ((c1 & 0x03ff) << 10) + (c2 & 0x03ff)\n\t\t\t\t\t\t\ti++\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 18 | 0xf0\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 12 & 0x3f | 0x80\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 & 0x3f | 0x80\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 12 | 0xe0\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 & 0x3f | 0x80\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlength = strPosition - position - headerSize\n\t\t\t\t} else {\n\t\t\t\t\tlength = encodeUtf8(value, position + headerSize)\n\t\t\t\t}\n\n\t\t\t\tif (length < 0x20) {\n\t\t\t\t\ttarget[position++] = 0xa0 | length\n\t\t\t\t} else if (length < 0x100) {\n\t\t\t\t\tif (headerSize < 2) {\n\t\t\t\t\t\ttarget.copyWithin(position + 2, position + 1, position + 1 + length)\n\t\t\t\t\t}\n\t\t\t\t\ttarget[position++] = 0xd9\n\t\t\t\t\ttarget[position++] = length\n\t\t\t\t} else if (length < 0x10000) {\n\t\t\t\t\tif (headerSize < 3) {\n\t\t\t\t\t\ttarget.copyWithin(position + 3, position + 2, position + 2 + length)\n\t\t\t\t\t}\n\t\t\t\t\ttarget[position++] = 0xda\n\t\t\t\t\ttarget[position++] = length >> 8\n\t\t\t\t\ttarget[position++] = length & 0xff\n\t\t\t\t} else {\n\t\t\t\t\tif (headerSize < 5) {\n\t\t\t\t\t\ttarget.copyWithin(position + 5, position + 3, position + 3 + length)\n\t\t\t\t\t}\n\t\t\t\t\ttarget[position++] = 0xdb\n\t\t\t\t\ttargetView.setUint32(position, length)\n\t\t\t\t\tposition += 4\n\t\t\t\t}\n\t\t\t\tposition += length\n\t\t\t} else if (type === 'number') {\n\t\t\t\tif (value >>> 0 === value) {// positive integer, 32-bit or less\n\t\t\t\t\t// positive uint\n\t\t\t\t\tif (value < 0x20 || (value < 0x80 && this.useRecords === false) || (value < 0x40 && !this.randomAccessStructure)) {\n\t\t\t\t\t\ttarget[position++] = value\n\t\t\t\t\t} else if (value < 0x100) {\n\t\t\t\t\t\ttarget[position++] = 0xcc\n\t\t\t\t\t\ttarget[position++] = value\n\t\t\t\t\t} else if (value < 0x10000) {\n\t\t\t\t\t\ttarget[position++] = 0xcd\n\t\t\t\t\t\ttarget[position++] = value >> 8\n\t\t\t\t\t\ttarget[position++] = value & 0xff\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget[position++] = 0xce\n\t\t\t\t\t\ttargetView.setUint32(position, value)\n\t\t\t\t\t\tposition += 4\n\t\t\t\t\t}\n\t\t\t\t} else if (value >> 0 === value) { // negative integer\n\t\t\t\t\tif (value >= -0x20) {\n\t\t\t\t\t\ttarget[position++] = 0x100 + value\n\t\t\t\t\t} else if (value >= -0x80) {\n\t\t\t\t\t\ttarget[position++] = 0xd0\n\t\t\t\t\t\ttarget[position++] = value + 0x100\n\t\t\t\t\t} else if (value >= -0x8000) {\n\t\t\t\t\t\ttarget[position++] = 0xd1\n\t\t\t\t\t\ttargetView.setInt16(position, value)\n\t\t\t\t\t\tposition += 2\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget[position++] = 0xd2\n\t\t\t\t\t\ttargetView.setInt32(position, value)\n\t\t\t\t\t\tposition += 4\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlet useFloat32\n\t\t\t\t\tif ((useFloat32 = this.useFloat32) > 0 && value < 0x100000000 && value >= -0x80000000) {\n\t\t\t\t\t\ttarget[position++] = 0xca\n\t\t\t\t\t\ttargetView.setFloat32(position, value)\n\t\t\t\t\t\tlet xShifted\n\t\t\t\t\t\tif (useFloat32 < 4 ||\n\t\t\t\t\t\t\t\t// this checks for rounding of numbers that were encoded in 32-bit float to nearest significant decimal digit that could be preserved\n\t\t\t\t\t\t\t\t((xShifted = value * mult10[((target[position] & 0x7f) << 1) | (target[position + 1] >> 7)]) >> 0) === xShifted) {\n\t\t\t\t\t\t\tposition += 4\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tposition-- // move back into position for writing a double\n\t\t\t\t\t}\n\t\t\t\t\ttarget[position++] = 0xcb\n\t\t\t\t\ttargetView.setFloat64(position, value)\n\t\t\t\t\tposition += 8\n\t\t\t\t}\n\t\t\t} else if (type === 'object' || type === 'function') {\n\t\t\t\tif (!value)\n\t\t\t\t\ttarget[position++] = 0xc0\n\t\t\t\telse {\n\t\t\t\t\tif (referenceMap) {\n\t\t\t\t\t\tlet referee = referenceMap.get(value)\n\t\t\t\t\t\tif (referee) {\n\t\t\t\t\t\t\tif (!referee.id) {\n\t\t\t\t\t\t\t\tlet idsToInsert = referenceMap.idsToInsert || (referenceMap.idsToInsert = [])\n\t\t\t\t\t\t\t\treferee.id = idsToInsert.push(referee)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttarget[position++] = 0xd6 // fixext 4\n\t\t\t\t\t\t\ttarget[position++] = 0x70 // \"p\" for pointer\n\t\t\t\t\t\t\ttargetView.setUint32(position, referee.id)\n\t\t\t\t\t\t\tposition += 4\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\treferenceMap.set(value, { offset: position - start })\n\t\t\t\t\t}\n\t\t\t\t\tlet constructor = value.constructor\n\t\t\t\t\tif (constructor === Object) {\n\t\t\t\t\t\twriteObject(value)\n\t\t\t\t\t} else if (constructor === Array) {\n\t\t\t\t\t\tpackArray(value)\n\t\t\t\t\t} else if (constructor === Map) {\n\t\t\t\t\t\tif (this.mapAsEmptyObject) target[position++] = 0x80\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tlength = value.size\n\t\t\t\t\t\t\tif (length < 0x10) {\n\t\t\t\t\t\t\t\ttarget[position++] = 0x80 | length\n\t\t\t\t\t\t\t} else if (length < 0x10000) {\n\t\t\t\t\t\t\t\ttarget[position++] = 0xde\n\t\t\t\t\t\t\t\ttarget[position++] = length >> 8\n\t\t\t\t\t\t\t\ttarget[position++] = length & 0xff\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget[position++] = 0xdf\n\t\t\t\t\t\t\t\ttargetView.setUint32(position, length)\n\t\t\t\t\t\t\t\tposition += 4\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (let [key, entryValue] of value) {\n\t\t\t\t\t\t\t\tpack(key)\n\t\t\t\t\t\t\t\tpack(entryValue)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (let i = 0, l = extensions.length; i < l; i++) {\n\t\t\t\t\t\t\tlet extensionClass = extensionClasses[i]\n\t\t\t\t\t\t\tif (value instanceof extensionClass) {\n\t\t\t\t\t\t\t\tlet extension = extensions[i]\n\t\t\t\t\t\t\t\tif (extension.write) {\n\t\t\t\t\t\t\t\t\tif (extension.type) {\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = 0xd4 // one byte \"tag\" extension\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = extension.type\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = 0\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tlet writeResult = extension.write.call(this, value)\n\t\t\t\t\t\t\t\t\tif (writeResult === value) { // avoid infinite recursion\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\t\t\t\t\t\t\tpackArray(value)\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\twriteObject(value)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpack(writeResult)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet currentTarget = target\n\t\t\t\t\t\t\t\tlet currentTargetView = targetView\n\t\t\t\t\t\t\t\tlet currentPosition = position\n\t\t\t\t\t\t\t\ttarget = null\n\t\t\t\t\t\t\t\tlet result\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tresult = extension.pack.call(this, value, (size) => {\n\t\t\t\t\t\t\t\t\t\t// restore target and use it\n\t\t\t\t\t\t\t\t\t\ttarget = currentTarget\n\t\t\t\t\t\t\t\t\t\tcurrentTarget = null\n\t\t\t\t\t\t\t\t\t\tposition += size\n\t\t\t\t\t\t\t\t\t\tif (position > safeEnd)\n\t\t\t\t\t\t\t\t\t\t\tmakeRoom(position)\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\ttarget, targetView, position: position - size\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, pack)\n\t\t\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\t\t\t// restore current target information (unless already restored)\n\t\t\t\t\t\t\t\t\tif (currentTarget) {\n\t\t\t\t\t\t\t\t\t\ttarget = currentTarget\n\t\t\t\t\t\t\t\t\t\ttargetView = currentTargetView\n\t\t\t\t\t\t\t\t\t\tposition = currentPosition\n\t\t\t\t\t\t\t\t\t\tsafeEnd = target.length - 10\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\t\t\tif (result.length + position > safeEnd)\n\t\t\t\t\t\t\t\t\t\tmakeRoom(result.length + position)\n\t\t\t\t\t\t\t\t\tposition = writeExtensionData(result, target, position, extension.type)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// check isArray after extensions, because extensions can extend Array\n\t\t\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\t\t\tpackArray(value)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// use this as an alternate mechanism for expressing how to serialize\n\t\t\t\t\t\t\tif (value.toJSON) {\n\t\t\t\t\t\t\t\tconst json = value.toJSON()\n\t\t\t\t\t\t\t\t// if for some reason value.toJSON returns itself it'll loop forever\n\t\t\t\t\t\t\t\tif (json !== value)\n\t\t\t\t\t\t\t\t\treturn pack(json)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// if there is a writeFunction, use it, otherwise just encode as undefined\n\t\t\t\t\t\t\tif (type === 'function')\n\t\t\t\t\t\t\t\treturn pack(this.writeFunction && this.writeFunction(value));\n\n\t\t\t\t\t\t\t// no extension found, write as plain object\n\t\t\t\t\t\t\twriteObject(value)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (type === 'boolean') {\n\t\t\t\ttarget[position++] = value ? 0xc3 : 0xc2\n\t\t\t} else if (type === 'bigint') {\n\t\t\t\tif (value < (BigInt(1)<<BigInt(63)) && value >= -(BigInt(1)<<BigInt(63))) {\n\t\t\t\t\t// use a signed int as long as it fits\n\t\t\t\t\ttarget[position++] = 0xd3\n\t\t\t\t\ttargetView.setBigInt64(position, value)\n\t\t\t\t} else if (value < (BigInt(1)<<BigInt(64)) && value > 0) {\n\t\t\t\t\t// if we can fit an unsigned int, use that\n\t\t\t\t\ttarget[position++] = 0xcf\n\t\t\t\t\ttargetView.setBigUint64(position, value)\n\t\t\t\t} else {\n\t\t\t\t\t// overflow\n\t\t\t\t\tif (this.largeBigIntToFloat) {\n\t\t\t\t\t\ttarget[position++] = 0xcb\n\t\t\t\t\t\ttargetView.setFloat64(position, Number(value))\n\t\t\t\t\t} else if (this.largeBigIntToString) {\n\t\t\t\t\t\treturn pack(value.toString());\n\t\t\t\t\t} else if (this.useBigIntExtension && value < BigInt(2)**BigInt(1023) && value > -(BigInt(2)**BigInt(1023))) {\n\t\t\t\t\t\ttarget[position++] = 0xc7\n\t\t\t\t\t\tposition++;\n\t\t\t\t\t\ttarget[position++] = 0x42 // \"B\" for BigInt\n\t\t\t\t\t\tlet bytes = [];\n\t\t\t\t\t\tlet alignedSign;\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tlet byte = value & BigInt(0xff);\n\t\t\t\t\t\t\talignedSign = (byte & BigInt(0x80)) === (value < BigInt(0) ? BigInt(0x80) : BigInt(0));\n\t\t\t\t\t\t\tbytes.push(byte);\n\t\t\t\t\t\t\tvalue >>= BigInt(8);\n\t\t\t\t\t\t} while (!((value === BigInt(0) || value === BigInt(-1)) && alignedSign));\n\t\t\t\t\t\ttarget[position-2] = bytes.length;\n\t\t\t\t\t\tfor (let i = bytes.length; i > 0;) {\n\t\t\t\t\t\t\ttarget[position++] = Number(bytes[--i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new RangeError(value + ' was too large to fit in MessagePack 64-bit integer format, use' +\n\t\t\t\t\t\t\t' useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set' +\n\t\t\t\t\t\t\t' largeBigIntToString to convert to string')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tposition += 8\n\t\t\t} else if (type === 'undefined') {\n\t\t\t\tif (this.encodeUndefinedAsNil)\n\t\t\t\t\ttarget[position++] = 0xc0\n\t\t\t\telse {\n\t\t\t\t\ttarget[position++] = 0xd4 // a number of implementations use fixext1 with type 0, data 0 to denote undefined, so we follow suite\n\t\t\t\t\ttarget[position++] = 0\n\t\t\t\t\ttarget[position++] = 0\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow new Error('Unknown type: ' + type)\n\t\t\t}\n\t\t}\n\n\t\tconst writePlainObject = (this.variableMapSize || this.coercibleKeyAsNumber || this.skipValues) ? (object) => {\n\t\t\t// this method is slightly slower, but generates \"preferred serialization\" (optimally small for smaller objects)\n\t\t\tlet keys;\n\t\t\tif (this.skipValues) {\n\t\t\t\tkeys = [];\n\t\t\t\tfor (let key in object) {\n\t\t\t\t\tif ((typeof object.hasOwnProperty !== 'function' || object.hasOwnProperty(key)) &&\n\t\t\t\t\t\t!this.skipValues.includes(object[key]))\n\t\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tkeys = Object.keys(object)\n\t\t\t}\n\t\t\tlet length = keys.length\n\t\t\tif (length < 0x10) {\n\t\t\t\ttarget[position++] = 0x80 | length\n\t\t\t} else if (length < 0x10000) {\n\t\t\t\ttarget[position++] = 0xde\n\t\t\t\ttarget[position++] = length >> 8\n\t\t\t\ttarget[position++] = length & 0xff\n\t\t\t} else {\n\t\t\t\ttarget[position++] = 0xdf\n\t\t\t\ttargetView.setUint32(position, length)\n\t\t\t\tposition += 4\n\t\t\t}\n\t\t\tlet key\n\t\t\tif (this.coercibleKeyAsNumber) {\n\t\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\t\tkey = keys[i]\n\t\t\t\t\tlet num = Number(key)\n\t\t\t\t\tpack(isNaN(num) ? key : num)\n\t\t\t\t\tpack(object[key])\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\t\tpack(key = keys[i])\n\t\t\t\t\tpack(object[key])\n\t\t\t\t}\n\t\t\t}\n\t\t} :\n\t\t(object) => {\n\t\t\ttarget[position++] = 0xde // always using map 16, so we can preallocate and set the length afterwards\n\t\t\tlet objectOffset = position - start\n\t\t\tposition += 2\n\t\t\tlet size = 0\n\t\t\tfor (let key in object) {\n\t\t\t\tif (typeof object.hasOwnProperty !== 'function' || object.hasOwnProperty(key)) {\n\t\t\t\t\tpack(key)\n\t\t\t\t\tpack(object[key])\n\t\t\t\t\tsize++\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (size > 0xffff) {\n\t\t\t\tthrow new Error('Object is too large to serialize with fast 16-bit map size,' +\n\t\t\t\t' use the \"variableMapSize\" option to serialize this object');\n\t\t\t}\n\t\t\ttarget[objectOffset++ + start] = size >> 8\n\t\t\ttarget[objectOffset + start] = size & 0xff\n\t\t}\n\n\t\tconst writeRecord = this.useRecords === false ? writePlainObject :\n\t\t(options.progressiveRecords && !useTwoByteRecords) ?  // this is about 2% faster for highly stable structures, since it only requires one for-in loop (but much more expensive when new structure needs to be written)\n\t\t(object) => {\n\t\t\tlet nextTransition, transition = structures.transitions || (structures.transitions = Object.create(null))\n\t\t\tlet objectOffset = position++ - start\n\t\t\tlet wroteKeys\n\t\t\tfor (let key in object) {\n\t\t\t\tif (typeof object.hasOwnProperty !== 'function' || object.hasOwnProperty(key)) {\n\t\t\t\t\tnextTransition = transition[key]\n\t\t\t\t\tif (nextTransition)\n\t\t\t\t\t\ttransition = nextTransition\n\t\t\t\t\telse {\n\t\t\t\t\t\t// record doesn't exist, create full new record and insert it\n\t\t\t\t\t\tlet keys = Object.keys(object)\n\t\t\t\t\t\tlet lastTransition = transition\n\t\t\t\t\t\ttransition = structures.transitions\n\t\t\t\t\t\tlet newTransitions = 0\n\t\t\t\t\t\tfor (let i = 0, l = keys.length; i < l; i++) {\n\t\t\t\t\t\t\tlet key = keys[i]\n\t\t\t\t\t\t\tnextTransition = transition[key]\n\t\t\t\t\t\t\tif (!nextTransition) {\n\t\t\t\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\n\t\t\t\t\t\t\t\tnewTransitions++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttransition = nextTransition\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (objectOffset + start + 1 == position) {\n\t\t\t\t\t\t\t// first key, so we don't need to insert, we can just write record directly\n\t\t\t\t\t\t\tposition--\n\t\t\t\t\t\t\tnewRecord(transition, keys, newTransitions)\n\t\t\t\t\t\t} else // otherwise we need to insert the record, moving existing data after the record\n\t\t\t\t\t\t\tinsertNewRecord(transition, keys, objectOffset, newTransitions)\n\t\t\t\t\t\twroteKeys = true\n\t\t\t\t\t\ttransition = lastTransition[key]\n\t\t\t\t\t}\n\t\t\t\t\tpack(object[key])\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!wroteKeys) {\n\t\t\t\tlet recordId = transition[RECORD_SYMBOL]\n\t\t\t\tif (recordId)\n\t\t\t\t\ttarget[objectOffset + start] = recordId\n\t\t\t\telse\n\t\t\t\t\tinsertNewRecord(transition, Object.keys(object), objectOffset, 0)\n\t\t\t}\n\t\t} :\n\t\t(object) => {\n\t\t\tlet nextTransition, transition = structures.transitions || (structures.transitions = Object.create(null))\n\t\t\tlet newTransitions = 0\n\t\t\tfor (let key in object) if (typeof object.hasOwnProperty !== 'function' || object.hasOwnProperty(key)) {\n\t\t\t\tnextTransition = transition[key]\n\t\t\t\tif (!nextTransition) {\n\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\n\t\t\t\t\tnewTransitions++\n\t\t\t\t}\n\t\t\t\ttransition = nextTransition\n\t\t\t}\n\t\t\tlet recordId = transition[RECORD_SYMBOL]\n\t\t\tif (recordId) {\n\t\t\t\tif (recordId >= 0x60 && useTwoByteRecords) {\n\t\t\t\t\ttarget[position++] = ((recordId -= 0x60) & 0x1f) + 0x60\n\t\t\t\t\ttarget[position++] = recordId >> 5\n\t\t\t\t} else\n\t\t\t\t\ttarget[position++] = recordId\n\t\t\t} else {\n\t\t\t\tnewRecord(transition, transition.__keys__ || Object.keys(object), newTransitions)\n\t\t\t}\n\t\t\t// now write the values\n\t\t\tfor (let key in object)\n\t\t\t\tif (typeof object.hasOwnProperty !== 'function' || object.hasOwnProperty(key)) {\n\t\t\t\t\tpack(object[key])\n\t\t\t\t}\n\t\t}\n\n\t\t// create reference to useRecords if useRecords is a function\n\t\tconst checkUseRecords = typeof this.useRecords == 'function' && this.useRecords;\n\n\t\tconst writeObject = checkUseRecords ? (object) => {\n\t\t\tcheckUseRecords(object) ? writeRecord(object) : writePlainObject(object)\n\t\t} : writeRecord\n\n\t\tconst makeRoom = (end) => {\n\t\t\tlet newSize\n\t\t\tif (end > 0x1000000) {\n\t\t\t\t// special handling for really large buffers\n\t\t\t\tif ((end - start) > MAX_BUFFER_SIZE)\n\t\t\t\t\tthrow new Error('Packed buffer would be larger than maximum buffer size')\n\t\t\t\tnewSize = Math.min(MAX_BUFFER_SIZE,\n\t\t\t\t\tMath.round(Math.max((end - start) * (end > 0x4000000 ? 1.25 : 2), 0x400000) / 0x1000) * 0x1000)\n\t\t\t} else // faster handling for smaller buffers\n\t\t\t\tnewSize = ((Math.max((end - start) << 2, target.length - 1) >> 12) + 1) << 12\n\t\t\tlet newBuffer = new ByteArrayAllocate(newSize)\n\t\t\ttargetView = newBuffer.dataView || (newBuffer.dataView = new DataView(newBuffer.buffer, 0, newSize))\n\t\t\tend = Math.min(end, target.length)\n\t\t\tif (target.copy)\n\t\t\t\ttarget.copy(newBuffer, 0, start, end)\n\t\t\telse\n\t\t\t\tnewBuffer.set(target.slice(start, end))\n\t\t\tposition -= start\n\t\t\tstart = 0\n\t\t\tsafeEnd = newBuffer.length - 10\n\t\t\treturn target = newBuffer\n\t\t}\n\t\tconst newRecord = (transition, keys, newTransitions) => {\n\t\t\tlet recordId = structures.nextId\n\t\t\tif (!recordId)\n\t\t\t\trecordId = 0x40\n\t\t\tif (recordId < sharedLimitId && this.shouldShareStructure && !this.shouldShareStructure(keys)) {\n\t\t\t\trecordId = structures.nextOwnId\n\t\t\t\tif (!(recordId < maxStructureId))\n\t\t\t\t\trecordId = sharedLimitId\n\t\t\t\tstructures.nextOwnId = recordId + 1\n\t\t\t} else {\n\t\t\t\tif (recordId >= maxStructureId)// cycle back around\n\t\t\t\t\trecordId = sharedLimitId\n\t\t\t\tstructures.nextId = recordId + 1\n\t\t\t}\n\t\t\tlet highByte = keys.highByte = recordId >= 0x60 && useTwoByteRecords ? (recordId - 0x60) >> 5 : -1\n\t\t\ttransition[RECORD_SYMBOL] = recordId\n\t\t\ttransition.__keys__ = keys\n\t\t\tstructures[recordId - 0x40] = keys\n\n\t\t\tif (recordId < sharedLimitId) {\n\t\t\t\tkeys.isShared = true\n\t\t\t\tstructures.sharedLength = recordId - 0x3f\n\t\t\t\thasSharedUpdate = true\n\t\t\t\tif (highByte >= 0) {\n\t\t\t\t\ttarget[position++] = (recordId & 0x1f) + 0x60\n\t\t\t\t\ttarget[position++] = highByte\n\t\t\t\t} else {\n\t\t\t\t\ttarget[position++] = recordId\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (highByte >= 0) {\n\t\t\t\t\ttarget[position++] = 0xd5 // fixext 2\n\t\t\t\t\ttarget[position++] = 0x72 // \"r\" record defintion extension type\n\t\t\t\t\ttarget[position++] = (recordId & 0x1f) + 0x60\n\t\t\t\t\ttarget[position++] = highByte\n\t\t\t\t} else {\n\t\t\t\t\ttarget[position++] = 0xd4 // fixext 1\n\t\t\t\t\ttarget[position++] = 0x72 // \"r\" record defintion extension type\n\t\t\t\t\ttarget[position++] = recordId\n\t\t\t\t}\n\n\t\t\t\tif (newTransitions)\n\t\t\t\t\ttransitionsCount += serializationsSinceTransitionRebuild * newTransitions\n\t\t\t\t// record the removal of the id, we can maintain our shared structure\n\t\t\t\tif (recordIdsToRemove.length >= maxOwnStructures)\n\t\t\t\t\trecordIdsToRemove.shift()[RECORD_SYMBOL] = 0 // we are cycling back through, and have to remove old ones\n\t\t\t\trecordIdsToRemove.push(transition)\n\t\t\t\tpack(keys)\n\t\t\t}\n\t\t}\n\t\tconst insertNewRecord = (transition, keys, insertionOffset, newTransitions) => {\n\t\t\tlet mainTarget = target\n\t\t\tlet mainPosition = position\n\t\t\tlet mainSafeEnd = safeEnd\n\t\t\tlet mainStart = start\n\t\t\ttarget = keysTarget\n\t\t\tposition = 0\n\t\t\tstart = 0\n\t\t\tif (!target)\n\t\t\t\tkeysTarget = target = new ByteArrayAllocate(8192)\n\t\t\tsafeEnd = target.length - 10\n\t\t\tnewRecord(transition, keys, newTransitions)\n\t\t\tkeysTarget = target\n\t\t\tlet keysPosition = position\n\t\t\ttarget = mainTarget\n\t\t\tposition = mainPosition\n\t\t\tsafeEnd = mainSafeEnd\n\t\t\tstart = mainStart\n\t\t\tif (keysPosition > 1) {\n\t\t\t\tlet newEnd = position + keysPosition - 1\n\t\t\t\tif (newEnd > safeEnd)\n\t\t\t\t\tmakeRoom(newEnd)\n\t\t\t\tlet insertionPosition = insertionOffset + start\n\t\t\t\ttarget.copyWithin(insertionPosition + keysPosition, insertionPosition + 1, position)\n\t\t\t\ttarget.set(keysTarget.slice(0, keysPosition), insertionPosition)\n\t\t\t\tposition = newEnd\n\t\t\t} else {\n\t\t\t\ttarget[insertionOffset + start] = keysTarget[0]\n\t\t\t}\n\t\t}\n\t\tconst writeStruct = (object) => {\n\t\t\tlet newPosition = writeStructSlots(object, target, start, position, structures, makeRoom, (value, newPosition, notifySharedUpdate) => {\n\t\t\t\tif (notifySharedUpdate)\n\t\t\t\t\treturn hasSharedUpdate = true;\n\t\t\t\tposition = newPosition;\n\t\t\t\tlet startTarget = target;\n\t\t\t\tpack(value);\n\t\t\t\tresetStructures();\n\t\t\t\tif (startTarget !== target) {\n\t\t\t\t\treturn { position, targetView, target }; // indicate the buffer was re-allocated\n\t\t\t\t}\n\t\t\t\treturn position;\n\t\t\t}, this);\n\t\t\tif (newPosition === 0) // bail and go to a msgpack object\n\t\t\t\treturn writeObject(object);\n\t\t\tposition = newPosition;\n\t\t}\n\t}\n\tuseBuffer(buffer) {\n\t\t// this means we are finished using our own buffer and we can write over it safely\n\t\ttarget = buffer\n\t\ttarget.dataView || (target.dataView = new DataView(target.buffer, target.byteOffset, target.byteLength))\n\t\tposition = 0\n\t}\n\tset position (value) {\n\t\tposition = value;\n\t}\n\tget position() {\n\t\treturn position;\n\t}\n\tset buffer (buffer) {\n\t\ttarget = buffer;\n\t}\n\tget buffer () {\n\t\treturn target;\n\t}\n\tclearSharedData() {\n\t\tif (this.structures)\n\t\t\tthis.structures = []\n\t\tif (this.typedStructs)\n\t\t\tthis.typedStructs = []\n\t}\n}\n\nextensionClasses = [ Date, Set, Error, RegExp, ArrayBuffer, Object.getPrototypeOf(Uint8Array.prototype).constructor /*TypedArray*/, C1Type ]\nextensions = [{\n\tpack(date, allocateForWrite, pack) {\n\t\tlet seconds = date.getTime() / 1000\n\t\tif ((this.useTimestamp32 || date.getMilliseconds() === 0) && seconds >= 0 && seconds < 0x100000000) {\n\t\t\t// Timestamp 32\n\t\t\tlet { target, targetView, position} = allocateForWrite(6)\n\t\t\ttarget[position++] = 0xd6\n\t\t\ttarget[position++] = 0xff\n\t\t\ttargetView.setUint32(position, seconds)\n\t\t} else if (seconds > 0 && seconds < 0x100000000) {\n\t\t\t// Timestamp 64\n\t\t\tlet { target, targetView, position} = allocateForWrite(10)\n\t\t\ttarget[position++] = 0xd7\n\t\t\ttarget[position++] = 0xff\n\t\t\ttargetView.setUint32(position, date.getMilliseconds() * 4000000 + ((seconds / 1000 / 0x100000000) >> 0))\n\t\t\ttargetView.setUint32(position + 4, seconds)\n\t\t} else if (isNaN(seconds)) {\n\t\t\tif (this.onInvalidDate) {\n\t\t\t\tallocateForWrite(0)\n\t\t\t\treturn pack(this.onInvalidDate())\n\t\t\t}\n\t\t\t// Intentionally invalid timestamp\n\t\t\tlet { target, targetView, position} = allocateForWrite(3)\n\t\t\ttarget[position++] = 0xd4\n\t\t\ttarget[position++] = 0xff\n\t\t\ttarget[position++] = 0xff\n\t\t} else {\n\t\t\t// Timestamp 96\n\t\t\tlet { target, targetView, position} = allocateForWrite(15)\n\t\t\ttarget[position++] = 0xc7\n\t\t\ttarget[position++] = 12\n\t\t\ttarget[position++] = 0xff\n\t\t\ttargetView.setUint32(position, date.getMilliseconds() * 1000000)\n\t\t\ttargetView.setBigInt64(position + 4, BigInt(Math.floor(seconds)))\n\t\t}\n\t}\n}, {\n\tpack(set, allocateForWrite, pack) {\n\t\tif (this.setAsEmptyObject) {\n\t\t\tallocateForWrite(0);\n\t\t\treturn pack({})\n\t\t}\n\t\tlet array = Array.from(set)\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\n\t\tif (this.moreTypes) {\n\t\t\ttarget[position++] = 0xd4\n\t\t\ttarget[position++] = 0x73 // 's' for Set\n\t\t\ttarget[position++] = 0\n\t\t}\n\t\tpack(array)\n\t}\n}, {\n\tpack(error, allocateForWrite, pack) {\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\n\t\tif (this.moreTypes) {\n\t\t\ttarget[position++] = 0xd4\n\t\t\ttarget[position++] = 0x65 // 'e' for error\n\t\t\ttarget[position++] = 0\n\t\t}\n\t\tpack([ error.name, error.message, error.cause ])\n\t}\n}, {\n\tpack(regex, allocateForWrite, pack) {\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\n\t\tif (this.moreTypes) {\n\t\t\ttarget[position++] = 0xd4\n\t\t\ttarget[position++] = 0x78 // 'x' for regeXp\n\t\t\ttarget[position++] = 0\n\t\t}\n\t\tpack([ regex.source, regex.flags ])\n\t}\n}, {\n\tpack(arrayBuffer, allocateForWrite) {\n\t\tif (this.moreTypes)\n\t\t\twriteExtBuffer(arrayBuffer, 0x10, allocateForWrite)\n\t\telse\n\t\t\twriteBuffer(hasNodeBuffer ? Buffer.from(arrayBuffer) : new Uint8Array(arrayBuffer), allocateForWrite)\n\t}\n}, {\n\tpack(typedArray, allocateForWrite) {\n\t\tlet constructor = typedArray.constructor\n\t\tif (constructor !== ByteArray && this.moreTypes)\n\t\t\twriteExtBuffer(typedArray, typedArrays.indexOf(constructor.name), allocateForWrite)\n\t\telse\n\t\t\twriteBuffer(typedArray, allocateForWrite)\n\t}\n}, {\n\tpack(c1, allocateForWrite) { // specific 0xC1 object\n\t\tlet { target, position} = allocateForWrite(1)\n\t\ttarget[position] = 0xc1\n\t}\n}]\n\nfunction writeExtBuffer(typedArray, type, allocateForWrite, encode) {\n\tlet length = typedArray.byteLength\n\tif (length + 1 < 0x100) {\n\t\tvar { target, position } = allocateForWrite(4 + length)\n\t\ttarget[position++] = 0xc7\n\t\ttarget[position++] = length + 1\n\t} else if (length + 1 < 0x10000) {\n\t\tvar { target, position } = allocateForWrite(5 + length)\n\t\ttarget[position++] = 0xc8\n\t\ttarget[position++] = (length + 1) >> 8\n\t\ttarget[position++] = (length + 1) & 0xff\n\t} else {\n\t\tvar { target, position, targetView } = allocateForWrite(7 + length)\n\t\ttarget[position++] = 0xc9\n\t\ttargetView.setUint32(position, length + 1) // plus one for the type byte\n\t\tposition += 4\n\t}\n\ttarget[position++] = 0x74 // \"t\" for typed array\n\ttarget[position++] = type\n\tif (!typedArray.buffer) typedArray = new Uint8Array(typedArray)\n\ttarget.set(new Uint8Array(typedArray.buffer, typedArray.byteOffset, typedArray.byteLength), position)\n}\nfunction writeBuffer(buffer, allocateForWrite) {\n\tlet length = buffer.byteLength\n\tvar target, position\n\tif (length < 0x100) {\n\t\tvar { target, position } = allocateForWrite(length + 2)\n\t\ttarget[position++] = 0xc4\n\t\ttarget[position++] = length\n\t} else if (length < 0x10000) {\n\t\tvar { target, position } = allocateForWrite(length + 3)\n\t\ttarget[position++] = 0xc5\n\t\ttarget[position++] = length >> 8\n\t\ttarget[position++] = length & 0xff\n\t} else {\n\t\tvar { target, position, targetView } = allocateForWrite(length + 5)\n\t\ttarget[position++] = 0xc6\n\t\ttargetView.setUint32(position, length)\n\t\tposition += 4\n\t}\n\ttarget.set(buffer, position)\n}\n\nfunction writeExtensionData(result, target, position, type) {\n\tlet length = result.length\n\tswitch (length) {\n\t\tcase 1:\n\t\t\ttarget[position++] = 0xd4\n\t\t\tbreak\n\t\tcase 2:\n\t\t\ttarget[position++] = 0xd5\n\t\t\tbreak\n\t\tcase 4:\n\t\t\ttarget[position++] = 0xd6\n\t\t\tbreak\n\t\tcase 8:\n\t\t\ttarget[position++] = 0xd7\n\t\t\tbreak\n\t\tcase 16:\n\t\t\ttarget[position++] = 0xd8\n\t\t\tbreak\n\t\tdefault:\n\t\t\tif (length < 0x100) {\n\t\t\t\ttarget[position++] = 0xc7\n\t\t\t\ttarget[position++] = length\n\t\t\t} else if (length < 0x10000) {\n\t\t\t\ttarget[position++] = 0xc8\n\t\t\t\ttarget[position++] = length >> 8\n\t\t\t\ttarget[position++] = length & 0xff\n\t\t\t} else {\n\t\t\t\ttarget[position++] = 0xc9\n\t\t\t\ttarget[position++] = length >> 24\n\t\t\t\ttarget[position++] = (length >> 16) & 0xff\n\t\t\t\ttarget[position++] = (length >> 8) & 0xff\n\t\t\t\ttarget[position++] = length & 0xff\n\t\t\t}\n\t}\n\ttarget[position++] = type\n\ttarget.set(result, position)\n\tposition += length\n\treturn position\n}\n\nfunction insertIds(serialized, idsToInsert) {\n\t// insert the ids that need to be referenced for structured clones\n\tlet nextId\n\tlet distanceToMove = idsToInsert.length * 6\n\tlet lastEnd = serialized.length - distanceToMove\n\twhile (nextId = idsToInsert.pop()) {\n\t\tlet offset = nextId.offset\n\t\tlet id = nextId.id\n\t\tserialized.copyWithin(offset + distanceToMove, offset, lastEnd)\n\t\tdistanceToMove -= 6\n\t\tlet position = offset + distanceToMove\n\t\tserialized[position++] = 0xd6\n\t\tserialized[position++] = 0x69 // 'i'\n\t\tserialized[position++] = id >> 24\n\t\tserialized[position++] = (id >> 16) & 0xff\n\t\tserialized[position++] = (id >> 8) & 0xff\n\t\tserialized[position++] = id & 0xff\n\t\tlastEnd = offset\n\t}\n\treturn serialized\n}\n\nfunction writeBundles(start, pack, incrementPosition) {\n\tif (bundledStrings.length > 0) {\n\t\ttargetView.setUint32(bundledStrings.position + start, position + incrementPosition - bundledStrings.position - start)\n\t\tbundledStrings.stringsPosition = position - start;\n\t\tlet writeStrings = bundledStrings\n\t\tbundledStrings = null\n\t\tpack(writeStrings[0])\n\t\tpack(writeStrings[1])\n\t}\n}\n\nexport function addExtension(extension) {\n\tif (extension.Class) {\n\t\tif (!extension.pack && !extension.write)\n\t\t\tthrow new Error('Extension has no pack or write function')\n\t\tif (extension.pack && !extension.type)\n\t\t\tthrow new Error('Extension has no type (numeric code to identify the extension)')\n\t\textensionClasses.unshift(extension.Class)\n\t\textensions.unshift(extension)\n\t}\n\tunpackAddExtension(extension)\n}\nfunction prepareStructures(structures, packr) {\n\tstructures.isCompatible = (existingStructures) => {\n\t\tlet compatible = !existingStructures || ((packr.lastNamedStructuresLength || 0) === existingStructures.length)\n\t\tif (!compatible) // we want to merge these existing structures immediately since we already have it and we are in the right transaction\n\t\t\tpackr._mergeStructures(existingStructures);\n\t\treturn compatible;\n\t}\n\treturn structures\n}\nexport function setWriteStructSlots(writeSlots, makeStructures) {\n\twriteStructSlots = writeSlots;\n\tprepareStructures = makeStructures;\n}\n\nlet defaultPackr = new Packr({ useRecords: false })\nexport const pack = defaultPackr.pack\nexport const encode = defaultPackr.pack\nexport const Encoder = Packr\nexport { FLOAT32_OPTIONS } from './unpack.js'\nimport { FLOAT32_OPTIONS } from './unpack.js'\nexport const { NEVER, ALWAYS, DECIMAL_ROUND, DECIMAL_FIT } = FLOAT32_OPTIONS\nexport const REUSE_BUFFER_MODE = 512\nexport const RESET_BUFFER_MODE = 1024\nexport const RESERVE_START_SPACE = 2048\n", "import { Packr } from './pack.js'\nimport { Unpackr } from './unpack.js'\n\n/**\n * Given an Iterable first argument, returns an Iterable where each value is packed as a Buffer\n * If the argument is only Async Iterable, the return value will be an Async Iterable.\n * @param {Iterable|Iterator|AsyncIterable|AsyncIterator} objectIterator - iterable source, like a Readable object stream, an array, Set, or custom object\n * @param {options} [options] - msgpackr pack options\n * @returns {IterableIterator|Promise.<AsyncIterableIterator>}\n */\nexport function packIter (objectIterator, options = {}) {\n  if (!objectIterator || typeof objectIterator !== 'object') {\n    throw new Error('first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable')\n  } else if (typeof objectIterator[Symbol.iterator] === 'function') {\n    return packIterSync(objectIterator, options)\n  } else if (typeof objectIterator.then === 'function' || typeof objectIterator[Symbol.asyncIterator] === 'function') {\n    return packIterAsync(objectIterator, options)\n  } else {\n    throw new Error('first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise')\n  }\n}\n\nfunction * packIterSync (objectIterator, options) {\n  const packr = new Packr(options)\n  for (const value of objectIterator) {\n    yield packr.pack(value)\n  }\n}\n\nasync function * packIterAsync (objectIterator, options) {\n  const packr = new Packr(options)\n  for await (const value of objectIterator) {\n    yield packr.pack(value)\n  }\n}\n\n/**\n * Given an Iterable/Iterator input which yields buffers, returns an IterableIterator which yields sync decoded objects\n * Or, given an Async Iterable/Iterator which yields promises resolving in buffers, returns an AsyncIterableIterator.\n * @param {Iterable|Iterator|AsyncIterable|AsyncIterableIterator} bufferIterator\n * @param {object} [options] - unpackr options\n * @returns {IterableIterator|Promise.<AsyncIterableIterator}\n */\nexport function unpackIter (bufferIterator, options = {}) {\n  if (!bufferIterator || typeof bufferIterator !== 'object') {\n    throw new Error('first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise')\n  }\n\n  const unpackr = new Unpackr(options)\n  let incomplete\n  const parser = (chunk) => {\n    let yields\n    // if there's incomplete data from previous chunk, concatinate and try again\n    if (incomplete) {\n      chunk = Buffer.concat([incomplete, chunk])\n      incomplete = undefined\n    }\n\n    try {\n      yields = unpackr.unpackMultiple(chunk)\n    } catch (err) {\n      if (err.incomplete) {\n        incomplete = chunk.slice(err.lastPosition)\n        yields = err.values\n      } else {\n        throw err\n      }\n    }\n    return yields\n  }\n\n  if (typeof bufferIterator[Symbol.iterator] === 'function') {\n    return (function * iter () {\n      for (const value of bufferIterator) {\n        yield * parser(value)\n      }\n    })()\n  } else if (typeof bufferIterator[Symbol.asyncIterator] === 'function') {\n    return (async function * iter () {\n      for await (const value of bufferIterator) {\n        yield * parser(value)\n      }\n    })()\n  }\n}\nexport const decodeIter = unpackIter\nexport const encodeIter = packIter", "export { Packr, Encoder, addExtension, pack, encode, NEVER, ALWAYS, DECIMAL_ROUND, DECIMAL_FIT, REUSE_BUFFER_MODE, RESET_BUFFER_MODE, RESERVE_START_SPACE } from './pack.js'\nexport { Unpackr, Decoder, C1, unpack, unpackMultiple, decode, FLOAT32_OPTIONS, clearSource, roundFloat32, isNativeAccelerationEnabled } from './unpack.js'\nexport { decodeIter, encodeIter } from './iterators.js'\nexport const useRecords = false\nexport const mapsAsObjects = true\n", "import { Connection } from './Connection';\nimport { Protocol } from './Protocol';\nimport { getSerializer, Serializer } from './serializer/Serializer';\n\n// The unused imports here are important for better `.d.ts` file generation\n// (Later merged with `dts-bundle-generator`)\nimport { createNanoEvents } from './core/nanoevents';\nimport { createSignal } from './core/signal';\n\nimport { decode, encode, Iterator } from '@colyseus/schema';\nimport { SchemaConstructor, SchemaSerializer } from './serializer/SchemaSerializer';\nimport { CloseCode } from './errors/Errors';\n\nimport { Packr, unpack } from '@colyseus/msgpackr';\n\nexport interface RoomAvailable<Metadata = any> {\n    name: string;\n    roomId: string;\n    clients: number;\n    maxClients: number;\n    metadata?: Metadata;\n}\n\nexport class Room<State= any> {\n    public roomId: string;\n    public sessionId: string;\n    public reconnectionToken: string;\n\n    public name: string;\n    public connection: Connection;\n\n    // Public signals\n    public onStateChange = createSignal<(state: State) => void>();\n    public onError = createSignal<(code: number, message?: string) => void>();\n    public onLeave = createSignal<(code: number, reason?: string) => void>();\n    protected onJoin = createSignal();\n\n    public serializerId: string;\n    public serializer: Serializer<State>;\n\n    protected hasJoined: boolean = false;\n\n    // TODO: remove me on 1.0.0\n    protected rootSchema: SchemaConstructor<State>;\n\n    protected onMessageHandlers = createNanoEvents();\n\n    protected packr: Packr;\n\n    constructor(name: string, rootSchema?: SchemaConstructor<State>) {\n        this.roomId = null;\n        this.name = name;\n\n        this.packr = new Packr();\n\n        // msgpackr workaround: force buffer to be created.\n        this.packr.encode(undefined);\n\n        if (rootSchema) {\n            this.serializer = new (getSerializer(\"schema\"));\n            this.rootSchema = rootSchema;\n            (this.serializer as SchemaSerializer).state = new rootSchema();\n        }\n\n        this.onError((code, message) => console.warn?.(`colyseus.js - onError => (${code}) ${message}`));\n        this.onLeave(() => this.removeAllListeners());\n    }\n\n    public connect(\n        endpoint: string,\n        devModeCloseCallback?: () => void,\n        room: Room = this, // when reconnecting on devMode, re-use previous room intance for handling events.\n        options?: any,\n        headers?: any,\n    ) {\n        const connection = new Connection(options.protocol);\n        room.connection = connection;\n\n        connection.events.onmessage = Room.prototype.onMessageCallback.bind(room);\n        connection.events.onclose = function (e: CloseEvent) {\n            if (!room.hasJoined) {\n                console.warn?.(`Room connection was closed unexpectedly (${e.code}): ${e.reason}`);\n                room.onError.invoke(e.code, e.reason);\n                return;\n            }\n            if (e.code === CloseCode.DEVMODE_RESTART && devModeCloseCallback) {\n                devModeCloseCallback();\n            } else {\n                room.onLeave.invoke(e.code, e.reason);\n                room.destroy();\n            }\n        };\n        connection.events.onerror = function (e: CloseEvent) {\n            console.warn?.(`Room, onError (${e.code}): ${e.reason}`);\n            room.onError.invoke(e.code, e.reason);\n        };\n\n        // FIXME: refactor this.\n        if (options.protocol === \"h3\") {\n            const url = new URL(endpoint);\n            connection.connect(url.origin, options);\n\n        } else {\n            connection.connect(endpoint, headers);\n        }\n\n    }\n\n    public leave(consented: boolean = true): Promise<number> {\n        return new Promise((resolve) => {\n            this.onLeave((code) => resolve(code));\n\n            if (this.connection) {\n                if (consented) {\n                    this.packr.buffer[0] = Protocol.LEAVE_ROOM;\n                    this.connection.send(this.packr.buffer.subarray(0, 1));\n\n                } else {\n                    this.connection.close();\n                }\n\n            } else {\n                this.onLeave.invoke(CloseCode.CONSENTED);\n            }\n        });\n    }\n\n    public onMessage<T = any>(type: \"*\", callback: (type: string | number, message: T) => void)\n    public onMessage<T = any>(type: string | number, callback: (message: T) => void)\n    public onMessage(type: '*' | string | number, callback: (...args: any[]) => void) {\n        return this.onMessageHandlers.on(this.getMessageHandlerKey(type), callback);\n    }\n\n    public send<T = any>(type: string | number, message?: T): void {\n        const it: Iterator = { offset: 1 };\n        this.packr.buffer[0] = Protocol.ROOM_DATA;\n\n        if (typeof(type) === \"string\") {\n            encode.string(this.packr.buffer, type, it);\n\n        } else {\n            encode.number(this.packr.buffer, type, it);\n        }\n\n        // force packr to use beginning of the buffer\n        this.packr.position = 0;\n\n        const data = (message !== undefined)\n            ? this.packr.pack(message, 2048 + it.offset) // 2048 = RESERVE_START_SPACE\n            : this.packr.buffer.subarray(0, it.offset);\n\n        this.connection.send(data);\n    }\n\n    public sendUnreliable<T = any>(type: string | number, message?: T): void {\n        const it: Iterator = { offset: 1 };\n        this.packr.buffer[0] = Protocol.ROOM_DATA;\n\n        if (typeof(type) === \"string\") {\n            encode.string(this.packr.buffer, type, it);\n\n        } else {\n            encode.number(this.packr.buffer, type, it);\n        }\n\n        // force packr to use beginning of the buffer\n        this.packr.position = 0;\n\n        const data = (message !== undefined)\n            ? this.packr.pack(message, 2048 + it.offset) // 2048 = RESERVE_START_SPACE\n            : this.packr.buffer.subarray(0, it.offset);\n\n        this.connection.sendUnreliable(data);\n    }\n\n    public sendBytes(type: string | number, bytes: Uint8Array) {\n        const it: Iterator = { offset: 1 };\n        this.packr.buffer[0] = Protocol.ROOM_DATA_BYTES;\n\n        if (typeof(type) === \"string\") {\n            encode.string(this.packr.buffer, type, it);\n\n        } else {\n            encode.number(this.packr.buffer, type, it);\n        }\n\n        // check if buffer needs to be resized\n        // TODO: can we avoid this?\n        if (bytes.byteLength + it.offset > this.packr.buffer.byteLength) {\n            const newBuffer = new Uint8Array(it.offset + bytes.byteLength);\n            newBuffer.set(this.packr.buffer);\n            this.packr.useBuffer(newBuffer);\n        }\n\n        this.packr.buffer.set(bytes, it.offset);\n        this.connection.send(this.packr.buffer.subarray(0, it.offset + bytes.byteLength));\n    }\n\n    public get state (): State {\n        return this.serializer.getState();\n    }\n\n    public removeAllListeners() {\n        this.onJoin.clear();\n        this.onStateChange.clear();\n        this.onError.clear();\n        this.onLeave.clear();\n        this.onMessageHandlers.events = {};\n\n        if (this.serializer instanceof SchemaSerializer) {\n            // Remove callback references\n            this.serializer.decoder.root.callbacks = {};\n        }\n    }\n\n    protected onMessageCallback(event: MessageEvent) {\n        const buffer = new Uint8Array(event.data);\n\n        const it: Iterator = { offset: 1 };\n        const code = buffer[0];\n\n        if (code === Protocol.JOIN_ROOM) {\n            const reconnectionToken = decode.utf8Read(buffer, it, buffer[it.offset++]);\n            this.serializerId = decode.utf8Read(buffer, it, buffer[it.offset++]);\n\n            // Instantiate serializer if not locally available.\n            if (!this.serializer) {\n                const serializer = getSerializer(this.serializerId);\n                this.serializer = new serializer();\n            }\n\n            if (buffer.byteLength > it.offset && this.serializer.handshake) {\n                this.serializer.handshake(buffer, it);\n            }\n\n            this.reconnectionToken = `${this.roomId}:${reconnectionToken}`;\n\n            this.hasJoined = true;\n            this.onJoin.invoke();\n\n            // acknowledge successfull JOIN_ROOM\n            this.packr.buffer[0] = Protocol.JOIN_ROOM;\n            this.connection.send(this.packr.buffer.subarray(0, 1));\n\n        } else if (code === Protocol.ERROR) {\n            const code = decode.number(buffer, it);\n            const message = decode.string(buffer, it);\n\n            this.onError.invoke(code, message);\n\n        } else if (code === Protocol.LEAVE_ROOM) {\n            this.leave();\n\n        } else if (code === Protocol.ROOM_STATE) {\n            this.serializer.setState(buffer, it);\n            this.onStateChange.invoke(this.serializer.getState());\n\n        } else if (code === Protocol.ROOM_STATE_PATCH) {\n            this.serializer.patch(buffer, it);\n            this.onStateChange.invoke(this.serializer.getState());\n\n        } else if (code === Protocol.ROOM_DATA) {\n            const type = (decode.stringCheck(buffer, it))\n                ? decode.string(buffer, it)\n                : decode.number(buffer, it);\n\n            const message = (buffer.byteLength > it.offset)\n                ? unpack(buffer, { start: it.offset })\n                : undefined;\n\n            this.dispatchMessage(type, message);\n\n        } else if (code === Protocol.ROOM_DATA_BYTES) {\n            const type = (decode.stringCheck(buffer, it))\n                ? decode.string(buffer, it)\n                : decode.number(buffer, it);\n\n            this.dispatchMessage(type, buffer.subarray(it.offset));\n        }\n    }\n\n    private dispatchMessage(type: string | number, message: any) {\n        const messageType = this.getMessageHandlerKey(type);\n\n        if (this.onMessageHandlers.events[messageType]) {\n            this.onMessageHandlers.emit(messageType, message);\n\n        } else if (this.onMessageHandlers.events['*']) {\n            this.onMessageHandlers.emit('*', type, message);\n\n        } else {\n            console.warn?.(`colyseus.js: onMessage() not registered for type '${type}'.`);\n        }\n    }\n\n    private destroy () {\n        if (this.serializer) {\n            this.serializer.teardown();\n        }\n    }\n\n    private getMessageHandlerKey(type: string | number): string {\n        switch (typeof(type)) {\n            // string\n            case \"string\": return type;\n\n            // number\n            case \"number\": return `i${type}`;\n\n            default: throw new Error(\"invalid message type.\");\n        }\n    }\n\n}\n", "function apply(src, tar) {\n\ttar.headers = src.headers || {};\n\ttar.statusMessage = src.statusText;\n\ttar.statusCode = src.status;\n\ttar.data = src.response;\n}\n\nexport function send(method, uri, opts) {\n\treturn new Promise(function (res, rej) {\n\t\topts = opts || {};\n\t\tvar req = new XMLHttpRequest;\n\t\tvar k, tmp, arr, str=opts.body;\n\t\tvar headers = opts.headers || {};\n\n\t\t// IE compatible\n\t\tif (opts.timeout) req.timeout = opts.timeout;\n\t\treq.ontimeout = req.onerror = function (err) {\n\t\t\terr.timeout = err.type == 'timeout';\n\t\t\trej(err);\n\t\t};\n\n\t\treq.onabort = function (err) {\n\t\t\terr.aborted = true;\n\t\t\trej(err);\n\t\t};\n\n\t\treq.open(method, uri.href || uri);\n\n\t\treq.onload = function () {\n\t\t\tarr = req.getAllResponseHeaders().trim().split(/[\\r\\n]+/);\n\t\t\tapply(req, req); //=> req.headers\n\n\t\t\twhile (tmp = arr.shift()) {\n\t\t\t\ttmp = tmp.split(': ');\n\t\t\t\treq.headers[tmp.shift().toLowerCase()] = tmp.join(': ');\n\t\t\t}\n\n\t\t\ttmp = req.headers['content-type'];\n\t\t\tif (tmp && !!~tmp.indexOf('application/json')) {\n\t\t\t\ttry {\n\t\t\t\t\treq.data = JSON.parse(req.data, opts.reviver);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tapply(req, err);\n\t\t\t\t\treturn rej(err);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t(req.status >= 400 ? rej : res)(req);\n\t\t};\n\n\t\tif (typeof FormData < 'u' && str instanceof FormData) {\n\t\t\t// str = opts.body\n\t\t} else if (str && typeof str == 'object') {\n\t\t\theaders['content-type'] = 'application/json';\n\t\t\tstr = JSON.stringify(str);\n\t\t}\n\n\t\treq.withCredentials = !!opts.withCredentials;\n\n\t\tfor (k in headers) {\n\t\t\treq.setRequestHeader(k, headers[k]);\n\t\t}\n\n\t\treq.send(str);\n\n\t\tif (opts.signal) {\n\t\t\topts.signal.addEventListener('abort', function () {\n\t\t\t\treq.abort();\n\t\t\t});\n\t\t}\n\t});\n}\n\nexport var get = /*#__PURE__*/ send.bind(send, 'GET');\nexport var post = /*#__PURE__*/ send.bind(send, 'POST');\nexport var patch = /*#__PURE__*/ send.bind(send, 'PATCH');\nexport var del = /*#__PURE__*/ send.bind(send, 'DELETE');\nexport var put = /*#__PURE__*/ send.bind(send, 'PUT');\n", "import { Client } from \"./Client\";\nimport { AbortError, ServerError } from \"./errors/Errors\";\nimport * as httpie from \"@colyseus/httpie\";\n\nexport class HTTP {\n    public authToken: string;\n\n    constructor(\n        protected client: Client,\n        public headers: { [id: string]: string } = {},\n    ) {}\n\n    public get<T = any>(path: string, options: Partial<httpie.Options> = {}): Promise<httpie.Response<T>> {\n        return this.request(\"get\", path, options);\n    }\n\n    public post<T = any>(path: string, options: Partial<httpie.Options> = {}): Promise<httpie.Response<T>> {\n        return this.request(\"post\", path, options);\n    }\n\n    public del<T = any>(path: string, options: Partial<httpie.Options> = {}): Promise<httpie.Response<T>> {\n        return this.request(\"del\", path, options);\n    }\n\n    public put<T = any>(path: string, options: Partial<httpie.Options> = {}): Promise<httpie.Response<T>> {\n        return this.request(\"put\", path, options);\n    }\n\n    protected request(method: \"get\" | \"post\" | \"put\" | \"del\", path: string, options: Partial<httpie.Options> = {}): Promise<httpie.Response> {\n        return httpie[method](this.client['getHttpEndpoint'](path), this.getOptions(options)).catch((e: any) => {\n            if (e.aborted) {\n                throw new AbortError(\"Request aborted\");\n            }\n\n            const status = e.statusCode; //  || -1\n            const message = e.data?.error || e.statusMessage || e.message; //  || \"offline\"\n\n            if (!status && !message) {\n                throw e;\n            }\n\n            throw new ServerError(status, message);\n        });\n    }\n\n    protected getOptions(options: Partial<httpie.Options>) {\n        // merge default custom headers with user headers\n        options.headers = Object.assign({}, this.headers, options.headers);\n\n        if (this.authToken) {\n            options.headers['Authorization'] = `Bearer ${this.authToken}`;\n        }\n\n        if (typeof (cc) !== 'undefined' && cc.sys && cc.sys.isNative) {\n            //\n            // Workaround for Cocos Creator on Native platform\n            // \"Cannot set property withCredentials of #<XMLHttpRequest> which has only a getter\"\n            //\n        } else {\n            // always include credentials\n            options.withCredentials = true;\n        }\n\n        return options;\n    }\n}\n", "/// <reference path=\"../typings/cocos-creator.d.ts\" />\n\n/**\n * We do not assign 'storage' to window.localStorage immediatelly for React\n * Native compatibility. window.localStorage is not present when this module is\n * loaded.\n */\n\nlet storage: any;\n\nfunction getStorage(): Storage {\n    if (!storage)  {\n        try {\n            storage = (typeof (cc) !== 'undefined' && cc.sys && cc.sys.localStorage)\n                ? cc.sys.localStorage  // compatibility with cocos creator\n                : window.localStorage; // RN does have window object at this point, but localStorage is not defined\n\n        } catch (e) {\n            // ignore error\n        }\n    }\n\n    if (!storage && typeof (globalThis.indexedDB) !== 'undefined') {\n        storage = new IndexedDBStorage();\n    }\n\n    if (!storage) {\n        // mock localStorage if not available (Node.js or RN environment)\n        storage = {\n            cache: {},\n            setItem: function (key, value) { this.cache[key] = value; },\n            getItem: function (key) { this.cache[key]; },\n            removeItem: function (key) { delete this.cache[key]; },\n        };\n    }\n\n    return storage;\n}\n\nexport function setItem(key: string, value: string) {\n    getStorage().setItem(key, value);\n}\n\nexport function removeItem(key: string) {\n    getStorage().removeItem(key);\n}\n\nexport function getItem(key: string, callback: Function) {\n    const value: any = getStorage().getItem(key);\n\n    if (\n        typeof (Promise) === 'undefined' || // old browsers\n        !(value instanceof Promise)\n    ) {\n        // browser has synchronous return\n        callback(value);\n\n    } else {\n        // react-native is asynchronous\n        value.then((id) => callback(id));\n    }\n}\n\n/**\n * When running in a Web Worker, we need to use IndexedDB to store data.\n */\nclass IndexedDBStorage {\n    private dbPromise: Promise<IDBDatabase> = new Promise((resolve) => {\n        const request = indexedDB.open('_colyseus_storage', 1);\n        request.onupgradeneeded = () => request.result.createObjectStore('store');\n        request.onsuccess = () => resolve(request.result);\n    });\n\n    private async tx(mode: IDBTransactionMode, fn: (store: IDBObjectStore) => IDBRequest) {\n        const db = await this.dbPromise;\n        const store = db.transaction('store', mode).objectStore('store');\n        return fn(store);\n    }\n\n    setItem(key: string, value: string) {\n        return this.tx('readwrite', store => store.put(value, key)).then();\n    }\n\n    async getItem(key: string) {\n        const request = await this.tx('readonly', store => store.get(key));\n        return new Promise<string | undefined>((resolve) => {\n            request.onsuccess = () => resolve(request.result);\n        });\n    }\n\n    removeItem(key: string) {\n        return this.tx('readwrite', store => store.delete(key)).then();\n    }\n}", "import { HTTP } from \"./HTTP\";\nimport { getItem, removeItem, setItem } from \"./Storage\";\nimport { createNanoEvents } from './core/nanoevents';\n\nexport interface AuthSettings {\n    path: string;\n    key: string;\n}\n\nexport interface PopupSettings {\n    prefix: string;\n    width: number;\n    height: number;\n}\n\nexport interface AuthData {\n    user: any;\n    token: string;\n}\n\nexport class Auth {\n    settings: AuthSettings = {\n        path: \"/auth\",\n        key: \"colyseus-auth-token\",\n    };\n\n    #_initialized = false;\n    #_initializationPromise: Promise<void>;\n    #_signInWindow = undefined;\n    #_events = createNanoEvents();\n\n    constructor(protected http: HTTP) {\n        getItem(this.settings.key, (token) => this.token = token);\n    }\n\n    public set token(token: string) {\n        this.http.authToken = token;\n    }\n\n    public get token(): string {\n        return this.http.authToken;\n    }\n\n    public onChange(callback: (response: AuthData) => void) {\n        const unbindChange = this.#_events.on(\"change\", callback);\n        if (!this.#_initialized) {\n            this.#_initializationPromise = new Promise<void>((resolve, reject) => {\n                this.getUserData().then((userData) => {\n                    this.emitChange({ ...userData, token: this.token });\n\n                }).catch((e) => {\n                    // user is not logged in, or service is down\n                    this.emitChange({ user: null, token: undefined });\n\n                }).finally(() => {\n                    resolve();\n                });\n            });\n        }\n        this.#_initialized = true;\n        return unbindChange;\n    }\n\n    public async getUserData() {\n        if (this.token) {\n            return (await this.http.get(`${this.settings.path}/userdata`)).data;\n        } else {\n            throw new Error(\"missing auth.token\");\n        }\n    }\n\n    public async registerWithEmailAndPassword(email: string, password: string, options?: any) {\n        const data = (await this.http.post(`${this.settings.path}/register`, {\n            body: { email, password, options, },\n        })).data;\n\n        this.emitChange(data);\n\n        return data;\n    }\n\n    public async signInWithEmailAndPassword(email: string, password: string) {\n        const data = (await this.http.post(`${this.settings.path}/login`, {\n            body: { email, password, },\n        })).data;\n\n        this.emitChange(data);\n\n        return data;\n    }\n\n    public async signInAnonymously(options?: any) {\n        const data = (await this.http.post(`${this.settings.path}/anonymous`, {\n            body: { options, }\n        })).data;\n\n        this.emitChange(data);\n\n        return data;\n    }\n\n    public async sendPasswordResetEmail(email: string) {\n        return (await this.http.post(`${this.settings.path}/forgot-password`, {\n            body: { email, }\n        })).data;\n    }\n\n    public async signInWithProvider(providerName: string, settings: Partial<PopupSettings> = {}) {\n        return new Promise((resolve, reject) => {\n            const w = settings.width || 480;\n            const h = settings.height || 768;\n\n            // forward existing token for upgrading\n            const upgradingToken = this.token ? `?token=${this.token}` : \"\";\n\n            // Capitalize first letter of providerName\n            const title = `Login with ${(providerName[0].toUpperCase() + providerName.substring(1))}`;\n            const url = this.http['client']['getHttpEndpoint'](`${(settings.prefix || `${this.settings.path}/provider`)}/${providerName}${upgradingToken}`);\n\n            const left = (screen.width / 2) - (w / 2);\n            const top = (screen.height / 2) - (h / 2);\n\n            this.#_signInWindow = window.open(url, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);\n\n            const onMessage = (event: MessageEvent) => {\n                // TODO: it is a good idea to check if event.origin can be trusted!\n                // if (event.origin.indexOf(window.location.hostname) === -1) { return; }\n\n                // require 'user' and 'token' inside received data.\n                if (event.data.user === undefined && event.data.token === undefined) { return; }\n\n                clearInterval(rejectionChecker);\n                this.#_signInWindow.close();\n                this.#_signInWindow = undefined;\n\n                window.removeEventListener(\"message\", onMessage);\n\n                if (event.data.error !== undefined) {\n                    reject(event.data.error);\n\n                } else {\n                    resolve(event.data);\n                    this.emitChange(event.data);\n                }\n            }\n\n            const rejectionChecker = setInterval(() => {\n                if (!this.#_signInWindow || this.#_signInWindow.closed) {\n                    this.#_signInWindow = undefined;\n                    reject(\"cancelled\");\n                    window.removeEventListener(\"message\", onMessage);\n                }\n            }, 200);\n\n            window.addEventListener(\"message\", onMessage);\n        });\n    }\n\n    public async signOut() {\n        this.emitChange({ user: null, token: null });\n    }\n\n    private emitChange(authData: Partial<AuthData>) {\n        if (authData.token !== undefined) {\n            this.token = authData.token;\n\n            if (authData.token === null) {\n                removeItem(this.settings.key);\n\n            } else {\n                // store key in localStorage\n                setItem(this.settings.key, authData.token);\n            }\n        }\n\n        this.#_events.emit(\"change\", authData);\n    }\n\n}\n", "/**\n * Discord Embedded App SDK\n * https://github.com/colyseus/colyseus/issues/707\n *\n * All URLs must go through the local proxy from\n * https://<app_id>.discordsays.com/.proxy/<mapped_url>/...\n *\n * URL Mapping Examples:\n *\n * 1. Using Colyseus Cloud:\n *   - /colyseus/{subdomain} -> {subdomain}.colyseus.cloud\n *\n *   Example:\n *     const client = new Client(\"https://xxxx.colyseus.cloud\");\n *\n * -------------------------------------------------------------\n *\n * 2. Using `cloudflared` tunnel:\n *   - /colyseus/ -> <your-cloudflared-url>.trycloudflare.com\n *\n *   Example:\n *     const client = new Client(\"https://<your-cloudflared-url>.trycloudflare.com\");\n *\n * -------------------------------------------------------------\n *\n * 3. Providing a manual /.proxy/your-mapping:\n *   - /your-mapping/ -> your-endpoint.com\n *\n *   Example:\n *     const client = new Client(\"/.proxy/your-mapping\");\n *\n */\nexport function discordURLBuilder (url: URL): string {\n    const localHostname = window?.location?.hostname || \"localhost\";\n\n    const remoteHostnameSplitted = url.hostname.split('.');\n    const subdomain = (\n        !url.hostname.includes(\"trycloudflare.com\") && // ignore cloudflared subdomains\n        !url.hostname.includes(\"discordsays.com\") &&  // ignore discordsays.com subdomains\n        remoteHostnameSplitted.length > 2\n    )\n        ? `/${remoteHostnameSplitted[0]}`\n        : '';\n\n    return (url.pathname.startsWith(\"/.proxy\"))\n        ? `${url.protocol}//${localHostname}${subdomain}${url.pathname}${url.search}`\n        : `${url.protocol}//${localHostname}/.proxy/colyseus${subdomain}${url.pathname}${url.search}`;\n}\n", "import { ServerError } from './errors/Errors';\nimport { Room } from './Room';\nimport { SchemaConstructor } from './serializer/SchemaSerializer';\nimport { HTTP } from \"./HTTP\";\nimport { Auth } from './Auth';\nimport { SeatReservation } from './Protocol';\nimport { discordURLBuilder } from './3rd_party/discord';\n\nexport type JoinOptions = any;\n\nexport class MatchMakeError extends Error {\n    code: number;\n    constructor(message: string, code: number) {\n        super(message);\n        this.code = code;\n        this.name = \"MatchMakeError\";\n        Object.setPrototypeOf(this, MatchMakeError.prototype);\n    }\n}\n\n// - React Native does not provide `window.location`\n// - Cocos Creator (Native) does not provide `window.location.hostname`\nconst DEFAULT_ENDPOINT = (typeof (window) !== \"undefined\" &&  typeof (window?.location?.hostname) !== \"undefined\")\n    ? `${window.location.protocol.replace(\"http\", \"ws\")}//${window.location.hostname}${(window.location.port && `:${window.location.port}`)}`\n    : \"ws://127.0.0.1:2567\";\n\nexport interface EndpointSettings {\n    hostname: string,\n    secure: boolean,\n    port?: number,\n    pathname?: string,\n    searchParams?: string,\n}\n\nexport interface ClientOptions {\n    headers?: { [id: string]: string };\n    urlBuilder?: (url: URL) => string;\n}\n\nexport class Client {\n    static VERSION = process.env.VERSION;\n\n    public http: HTTP;\n    public auth: Auth;\n\n    protected settings: EndpointSettings;\n    protected urlBuilder: (url: URL) => string;\n\n    constructor(\n        settings: string | EndpointSettings = DEFAULT_ENDPOINT,\n        options?: ClientOptions,\n    ) {\n        if (typeof (settings) === \"string\") {\n\n            //\n            // endpoint by url\n            //\n            const url = (settings.startsWith(\"/\"))\n                ? new URL(settings, DEFAULT_ENDPOINT)\n                : new URL(settings);\n\n            const secure = (url.protocol === \"https:\" || url.protocol === \"wss:\");\n            const port = Number(url.port || (secure ? 443 : 80));\n\n            this.settings = {\n                hostname: url.hostname,\n                pathname: url.pathname,\n                port,\n                secure,\n                searchParams: url.searchParams.toString() || undefined,\n            };\n\n        } else {\n            //\n            // endpoint by settings\n            //\n            if (settings.port === undefined) {\n                settings.port = (settings.secure) ? 443 : 80;\n            }\n            if (settings.pathname === undefined) {\n                settings.pathname = \"\";\n            }\n            this.settings = settings;\n        }\n\n        // make sure pathname does not end with \"/\"\n        if (this.settings.pathname.endsWith(\"/\")) {\n            this.settings.pathname = this.settings.pathname.slice(0, -1);\n        }\n\n        this.http = new HTTP(this, options?.headers || {});\n        this.auth = new Auth(this.http);\n\n        this.urlBuilder = options?.urlBuilder;\n\n        //\n        // Discord Embedded SDK requires a custom URL builder\n        //\n        if (\n            !this.urlBuilder &&\n            typeof (window) !== \"undefined\" &&\n            window?.location?.hostname?.includes(\"discordsays.com\")\n        ) {\n            this.urlBuilder = discordURLBuilder;\n            console.log(\"Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder.\");\n        }\n    }\n\n    public async joinOrCreate<T = any>(roomName: string, options: JoinOptions = {}, rootSchema?: SchemaConstructor<T>) {\n        return await this.createMatchMakeRequest<T>('joinOrCreate', roomName, options, rootSchema);\n    }\n\n    public async create<T = any>(roomName: string, options: JoinOptions = {}, rootSchema?: SchemaConstructor<T>) {\n        return await this.createMatchMakeRequest<T>('create', roomName, options, rootSchema);\n    }\n\n    public async join<T = any>(roomName: string, options: JoinOptions = {}, rootSchema?: SchemaConstructor<T>) {\n        return await this.createMatchMakeRequest<T>('join', roomName, options, rootSchema);\n    }\n\n    public async joinById<T = any>(roomId: string, options: JoinOptions = {}, rootSchema?: SchemaConstructor<T>) {\n        return await this.createMatchMakeRequest<T>('joinById', roomId, options, rootSchema);\n    }\n\n    /**\n     * Re-establish connection with a room this client was previously connected to.\n     *\n     * @param reconnectionToken The `room.reconnectionToken` from previously connected room.\n     * @param rootSchema (optional) Concrete root schema definition\n     * @returns Promise<Room>\n     */\n    public async reconnect<T = any>(reconnectionToken: string, rootSchema?: SchemaConstructor<T>) {\n        if (typeof (reconnectionToken) === \"string\" && typeof (rootSchema) === \"string\") {\n            throw new Error(\"DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\\nYou can get this token from previously connected `room.reconnectionToken`\");\n        }\n        const [roomId, token] = reconnectionToken.split(\":\");\n\t\tif (!roomId || !token) {\n\t\t\tthrow new Error(\"Invalid reconnection token format.\\nThe format should be roomId:reconnectionToken\");\n\t\t}\n        return await this.createMatchMakeRequest<T>('reconnect', roomId, { reconnectionToken: token }, rootSchema);\n    }\n\n    public async consumeSeatReservation<T = any>(\n        response: SeatReservation,\n        rootSchema?: SchemaConstructor<T>,\n        reuseRoomInstance?: Room // used in devMode\n    ): Promise<Room<T>> {\n        const room = this.createRoom<T>(response.room.name, rootSchema);\n        room.roomId = response.room.roomId;\n        room.sessionId = response.sessionId;\n\n        const options: any = { sessionId: room.sessionId };\n\n        // forward \"reconnection token\" in case of reconnection.\n        if (response.reconnectionToken) {\n            options.reconnectionToken = response.reconnectionToken;\n        }\n\n        const targetRoom = reuseRoomInstance || room;\n        room.connect(this.buildEndpoint(response.room, options, response.protocol), response.devMode && (async () => {\n            console.info(`[Colyseus devMode]: ${String.fromCodePoint(0x1F504)} Re-establishing connection with room id '${room.roomId}'...`); // \n\n            let retryCount = 0;\n            let retryMaxRetries = 8;\n\n            const retryReconnection = async () => {\n                retryCount++;\n\n                try {\n                    await this.consumeSeatReservation(response, rootSchema, targetRoom);\n                    console.info(`[Colyseus devMode]: ${String.fromCodePoint(0x2705)} Successfully re-established connection with room '${room.roomId}'`); // \n\n                } catch (e) {\n                    if (retryCount < retryMaxRetries) {\n                        console.info(`[Colyseus devMode]: ${String.fromCodePoint(0x1F504)} retrying... (${retryCount} out of ${retryMaxRetries})`); // \n                        setTimeout(retryReconnection, 2000);\n\n                    } else {\n                        console.info(`[Colyseus devMode]: ${String.fromCodePoint(0x274C)} Failed to reconnect. Is your server running? Please check server logs.`); // \n                    }\n                }\n            };\n\n            setTimeout(retryReconnection, 2000);\n        }), targetRoom, response, this.http.headers);\n\n        return new Promise((resolve, reject) => {\n            const onError = (code, message) => reject(new ServerError(code, message));\n            targetRoom.onError.once(onError);\n\n            targetRoom['onJoin'].once(() => {\n                targetRoom.onError.remove(onError);\n                resolve(targetRoom);\n            });\n        });\n    }\n\n    protected async createMatchMakeRequest<T = any>(\n        method: string,\n        roomName: string,\n        options: JoinOptions = {},\n        rootSchema?: SchemaConstructor<T>,\n        reuseRoomInstance?: Room,\n    ) {\n        const response = (\n            await this.http.post<SeatReservation>(`matchmake/${method}/${roomName}`, {\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(options)\n            })\n        ).data;\n\n        // FIXME: HTTP class is already handling this as ServerError.\n        // @ts-ignore\n        if (response.error) { throw new MatchMakeError(response.error, response.code); }\n\n        // forward reconnection token during \"reconnect\" methods.\n        if (method === \"reconnect\") {\n            response.reconnectionToken = options.reconnectionToken;\n        }\n\n        return await this.consumeSeatReservation<T>(response, rootSchema, reuseRoomInstance);\n    }\n\n    protected createRoom<T = any>(roomName: string, rootSchema?: SchemaConstructor<T>) {\n        return new Room<T>(roomName, rootSchema);\n    }\n\n    protected buildEndpoint(room: any, options: any = {}, protocol: string = \"ws\") {\n        let searchParams = this.settings.searchParams || \"\";\n\n        // forward authentication token\n        if (this.http.authToken) {\n            options['_authToken'] = this.http.authToken;\n        }\n\n        // append provided options\n        for (const name in options) {\n            if (!options.hasOwnProperty(name)) {\n                continue;\n            }\n            searchParams += (searchParams ? '&' : '') + `${name}=${options[name]}`;\n        }\n\n        if (protocol === \"h3\") {\n            protocol = \"http\";\n        }\n\n        let endpoint = (this.settings.secure)\n            ? `${protocol}s://`\n            : `${protocol}://`;\n\n        if (room.publicAddress) {\n            endpoint += `${room.publicAddress}`;\n\n        } else {\n            endpoint += `${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`;\n        }\n\n        const endpointURL = `${endpoint}/${room.processId}/${room.roomId}?${searchParams}`;\n        return (this.urlBuilder)\n            ? this.urlBuilder(new URL(endpointURL))\n            : endpointURL;\n    }\n\n    protected getHttpEndpoint(segments: string = '') {\n        const path = segments.startsWith(\"/\") ? segments : `/${segments}`;\n\n        let endpointURL = `${(this.settings.secure) ? \"https\" : \"http\"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}${path}`;\n\n        if (this.settings.searchParams) {\n            endpointURL += `?${this.settings.searchParams}`;\n        }\n\n        return (this.urlBuilder)\n            ? this.urlBuilder(new URL(endpointURL))\n            : endpointURL;\n    }\n\n    protected getEndpointPort() {\n        return (this.settings.port !== 80 && this.settings.port !== 443)\n            ? `:${this.settings.port}`\n            : \"\";\n    }\n}\n", "import { Serializer } from \"./Serializer\";\n\nexport class NoneSerializer<T = any> implements Serializer<T> {\n    setState(rawState: any): void {}\n    getState() { return null; }\n    patch(patches) {}\n    teardown() { }\n    handshake(bytes: number[]) {}\n}\n", "import './legacy';\n\nexport { Client, JoinOptions, MatchMakeError, type EndpointSettings, type ClientOptions } from './Client';\nexport { Protocol, ErrorCode, SeatReservation } from './Protocol';\nexport { Room, RoomAvailable } from './Room';\nexport { Auth, type AuthSettings, type PopupSettings } from \"./Auth\";\nexport { ServerError } from './errors/Errors';\n\n/*\n * Serializers\n */\nimport { SchemaSerializer, getStateCallbacks } from \"./serializer/SchemaSerializer\";\nimport { NoneSerializer } from \"./serializer/NoneSerializer\";\nimport { registerSerializer } from './serializer/Serializer';\n\nexport { registerSerializer, SchemaSerializer, getStateCallbacks };\nregisterSerializer('schema', SchemaSerializer);\nregisterSerializer('none', NoneSerializer);\n"],
  "mappings": "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",
  "names": ["CloseCode", "e", "encode", "decode", "H3TransportTransport", "WebSocketTransport", "Protocol", "ErrorCode", "_a", "getDecoderStateCallbacks", "Reflection", "Decoder", "readObject", "target", "encode", "target", "position", "targetView", "pack", "bundledStrings", "addExtension", "referenceMap", "maxBytes", "key", "newPosition", "addExtension", "createSignal", "createNanoEvents", "Packr", "getSerializer", "Connection", "CloseCode", "Protocol", "encode", "SchemaSerializer", "decode", "code", "unpack", "src", "httpie", "AbortError", "ServerError", "createNanoEvents", "getItem", "__classPrivateFieldGet", "__classPrivateFieldSet", "removeItem", "setItem", "HTTP", "Auth", "_a", "discordURLBuilder", "__awaiter", "ServerError", "Room", "registerSerializer", "SchemaSerializer", "NoneSerializer"]
}
